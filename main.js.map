{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/util.ts","webpack:///./src/resources.ts","webpack:///./src/world.ts","webpack:///./src/basic_sprites.ts","webpack:///./src/actors/hud.ts","webpack:///./src/actors/brand/logo.ts","webpack:///./src/actors/player/player.ts","webpack:///./src/actors/index.ts","webpack:///./src/actors/thing.ts","webpack:///./src/models.ts","webpack:///./src/game.ts","webpack:///./src/sounds/finemist.mp3","webpack:///./src/images/campfire.png","webpack:///./src/images/pylon.png","webpack:///./src/images/greatstone.png","webpack:///./src/images/stone.png","webpack:///./src/images/oak.png","webpack:///./src/images/greatOak.png","webpack:///./src/images/palm.png","webpack:///./src/images/greatpalm.png","webpack:///./src/images/miranda-portrait.png","webpack:///./src/images/miranda-sprites.png","webpack:///./src/images/alex-portrait.png","webpack:///./src/images/alex-sprites.png","webpack:///./src/images/basic-sprites.png","webpack:///./src/images/spritemap.png","webpack:///./src/images/brand.png","webpack:///./src/images/alpha.png","webpack:///./src/scenes/level-one/level-one.ts","webpack:///./src/index.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","p","jsonpArray","window","webpackJsonp","oldJsonpFunction","bind","slice","ex","coinflip","Math","random","clamp","min","max","val","clamped","keyToDirection","key","direction","Input","Keys","A","Left","D","Right","S","Down","W","Up","oppositeWay","dir","opp","mode","array","map","Map","maxFreq","item","freq","has","set","addScalarToVec","vec","step","y","x","dirFromVec","abs","angleFromDir","range","start","end","Array","fill","_","idx","excalibur_tiled_1","alpha","brand","spritemap","basicSprites","alex","alexPortrait","miranda","mirandaPortrait","greatPalm","palm","greatOak","oak","stone","greatStone","pylon","campfire","fineMist","Resources","Brand","Texture","Alphabet","Alex","AlexPortrait","Miranda","MirandaPortrait","Spritemap","BasicSprites","GreatPalm","Palm","Campfire","Oak","GreatOak","Stone","GreatStone","Pylon","FineMist","Sound","imagePathAccessor","path","tileset","replace","e","t","models_1","thing_1","resources_1","actors_1","Material","Wood","World","[object Object]","scene","hud","config","engine","this","island","Isle","itemKinds","playerCharacterMeta","sprites","SpriteSheet","portrait","asSprite","primary","debugBoxes","debugBoundingBoxes","stocks","wood","itemName","crafting","craftingItem","craftingAt","it","_primaryCharacter","equipped","spawn","kind","playerCell","equip","material","count","console","log","destroy","updateInventory","cell","Item","description","activate","Player","currentPc","message","__isle_pc","move","halt","makePrimaryCharacter","equipment","msg","describe","tileMap","getCellByPoint","__isle_item","entity","tol","entityAt","pos","entityNear","filter","Boolean","size","keys","getCellByIndex","index","cols","actor","kill","thing","Thing","drawing","addDrawing","constructCollisionArea","collision","theItem","buildItem","items","add","setZIndex","computeZ","pcMeta","pc","wireWorld","camera","strategy","lockToActor","zoom","playing","mapResource","_mapRes","terrainMeta","spriteTerrainById","spriteCollisionById","characterById","itemKindBySpriteId","tilesets","forEach","ts","terrains","terrain","properties","tile","reduce","acc","curr","assign","terrainName","tiles","id","terrainTile","solid","every","some","objectgroup","objects","prop","currMeta","warn","find","getTileMap","spriteId","spriteSheetKey","removeSprite","characterName","createPlayableCharacter","sheet","_spriteSheets","cx","cy","cellToRemove","newSprite","getSprite","babyPalm","babyOak","stoneBlock","BigCampfire","BasicSpriteMap","chestClosed","chestOpen","world_1","basic_sprites_1","inventorySprites","StockLine","yOff","baseFontFamily","label","Label","fontSize","color","Color","White","ctx","sprite","clone","scale","Vector","draw","text","Hud","UIActor","game","super","canvasWidth","canvasHeight","initialize","output","setWidth","textAlign","TextAlign","Center","Azure","inventory","fontFamily","lineItems","delta","activePlayer","baseFont","currentPlayer","playerPortrait","equipmentDrawing","setDrawing","remove","player","setStock","opacity","actions","clearActions","fade","util_1","Logo","strobeClamp","strobe","intensity","ceil","Actor","spriteSheet","world","_world","vel","currentDrawing","facing","speed","walkSprites","collisionArea","body","useCircleCollision","collisionType","CollisionType","Active","recalc","playerSpeed","interacting","usingItem","down","up","right","left","walkFrames","getAnimationByIndices","interactionPos","entityAndCell","interact","equipSprite","entities","entitiesNear","entitiesInteracted","useItem","getCenter","usingItemTicks","interactUsingEquipped","equipmentPos","littleDrawing","ticks","flipHorizontal","anchor","rotation","equipPos","debugDraw","Chartreuse","fillRect","update","itemSwingTime","player_1","logo_1","zOff","LightGray","Fixed","ellipse","center","width","height","polygon","vecs","usePolygonCollision","useBoxCollision","setHeight","PreventCollision","Tree","hitPoints","state","hp","damage","hitBy","blowUp","basis","baseCells","offset","base","logKind","LittleTree","itemClasses","Chest","open","BabyPalm","BabyOak","WoodLog","collect","WoodLogStack","StoneBlock","Handaxe","Machete","Game","Engine","displayMode","DisplayMode","FullScreen","setup","loader","Loader","addResource","logo","logoWidth","playButtonText","then","kick","LevelOne","Scene","level_one_1","game_1","hud_1","debugCells","bgMusic","levelOne","input","keyboard","on","evt","currentScene","primaryCharacter","E","interaction","C","enterCraftMode","processTiledMap","addTileMap","goToScene","theme","setTimeout","play","pointers","debit","useEquippedItem"],"mappings":"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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([31,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import * as ex from 'excalibur';\n\n// tiny probability handler...\nconst coinflip = () => Math.random() > 0.5\n\n// restrain a value between a min and a max\nconst clamp = (min: number, max: number) => (val: number) => {\n  let clamped = Math.min(val, max);\n  clamped = Math.max(clamped, min);\n  return clamped;\n}\n\ntype Direction = 'left' | 'right' | 'up' | 'down';\n\nconst keyToDirection = (key: number): Direction => {\n  let direction : Direction;\n  if (key === ex.Input.Keys.A || key === ex.Input.Keys.Left) {\n    direction = 'left';\n  }\n  if (key === ex.Input.Keys.D || key === ex.Input.Keys.Right) {\n    direction = 'right';\n  }\n  if (key === ex.Input.Keys.S || key === ex.Input.Keys.Down) {\n    direction = 'down';\n  }\n  if (key === ex.Input.Keys.W || key === ex.Input.Keys.Up) {\n    direction = 'up';\n  }\n  return direction;\n}\n\nconst oppositeWay = (dir: Direction): Direction => {\n  let opp: Direction;\n  switch(dir) {\n    case 'left': opp = 'right'; break;\n    case 'right': opp = 'left'; break;\n    case 'up': opp = 'down'; break;\n    case 'down': opp = 'up'; break;\n  }\n  return opp;\n}\n\n// suggested impl from https://codereview.stackexchange.com/a/169667\nconst mode = (array) => {\n  const map = new Map(); // new Map();\n\n  let maxFreq = 0;\n  let mode;\n\n  for(const item of array) {\n    let freq = map.has(item) ? map.get(item) : 0;\n    freq++;\n\n    if(freq > maxFreq) {\n      maxFreq = freq;\n      mode = item;\n    }\n    \n    map.set(item, freq);\n  }\n\n  return mode;\n};\n\nconst addScalarToVec = (vec: ex.Vector, direction: Direction, step: number) => {\n  switch (direction) {\n    case 'up':\n      vec.y -= step;\n      break;\n    case 'down':\n      vec.y += step;\n      break;\n    case 'left':\n      vec.x -= step;\n      break;\n    case 'right':\n      vec.x += step;\n      break;\n  }\n}\n\nconst dirFromVec = (vec: ex.Vector): Direction => {\n  let {x,y} = vec;\n  if (Math.abs(x) > Math.abs(y)) {\n    return x > 0 ? 'right' : 'left';\n  } else {\n    return y > 0 ? 'down' : 'up';\n  }\n}\n\nconst angleFromDir = (dir: Direction): number => {\n   switch (dir) {\n    case 'up':\n      return 90;\n    case 'down':\n      return 270;\n    case 'left':\n      return 180;\n    case 'right':\n      return 0;\n  }\n \n}\n\nfunction range(start, end): Array<number> {\n  return Array(end - start + 1).fill(0).map((_, idx) => start + idx)\n}\n\nexport {\n  clamp,\n  Direction,\n  keyToDirection,\n  addScalarToVec,\n  dirFromVec,\n  oppositeWay,\n  mode,\n  coinflip,\n  angleFromDir,\n  range\n};\n","import * as ex from 'excalibur';\r\nimport TiledResource from '@excaliburjs/excalibur-tiled';\r\n\r\nconst alpha = require('./images/alpha.png')\r\nconst brand = require('./images/brand.png')\r\n// const sword = require('./images/sword.png');\r\nconst spritemap = require('./images/spritemap.png')\r\nconst basicSprites = require('./images/basic-sprites.png')\r\n\r\nconst alex = require('./images/alex-sprites.png')\r\nconst alexPortrait = require('./images/alex-portrait.png')\r\n\r\nconst miranda = require('./images/miranda-sprites.png')\r\nconst mirandaPortrait = require('./images/miranda-portrait.png')\r\n\r\nconst greatPalm = require('./images/greatpalm.png')\r\nconst palm = require('./images/palm.png')\r\n\r\nconst greatOak = require('./images/greatOak.png')\r\nconst oak = require('./images/oak.png')\r\n\r\nconst stone = require('./images/stone.png')\r\nconst greatStone = require('./images/greatstone.png')\r\nconst pylon = require('./images/pylon.png')\r\n\r\nconst campfire = require('./images/campfire.png')\r\n\r\nconst fineMist = require('./sounds/finemist.mp3')\r\n// const science = require('./sounds/science.mp3')\r\n\r\nlet mapName = 'solidity';\r\n\r\nlet Resources = {\r\n    // app logo\r\n    Brand: new ex.Texture(brand),\r\n\r\n    // spritefont\r\n    Alphabet: new ex.Texture(alpha),\r\n\r\n    // images\r\n    Alex: new ex.Texture(alex),\r\n    AlexPortrait: new ex.Texture(alexPortrait),\r\n    Miranda: new ex.Texture(miranda),\r\n    MirandaPortrait: new ex.Texture(mirandaPortrait),\r\n\r\n    //Sword: new ex.Texture(sword),\r\n    Spritemap: new ex.Texture(spritemap), // SpriteSheet(spritemap)\r\n    BasicSprites: new ex.Texture(basicSprites),\r\n    Map: new TiledResource(`map/${mapName}.json`),\r\n    GreatPalm: new ex.Texture(greatPalm),\r\n    Palm: new ex.Texture(palm),\r\n    Campfire: new ex.Texture(campfire),\r\n\r\n    Oak: new ex.Texture(oak),\r\n    GreatOak: new ex.Texture(greatOak),\r\n\r\n    Stone: new ex.Texture(stone),\r\n    GreatStone: new ex.Texture(greatStone),\r\n\r\n    Pylon: new ex.Texture(pylon),\r\n\r\n    // music\r\n    FineMist: new ex.Sound(fineMist),\r\n    // Science: new ex.Sound(science)\r\n}\r\n\r\nResources.Map.imagePathAccessor = (path, tileset) => {\r\n    let actualPath = path.replace(/^(?:\\.\\.\\/)+/, \"\");\r\n    // console.log(\"LOAD IMG\", { path, actualPath });\r\n    return actualPath;\r\n    // return \"/assets/\" + path;\r\n}\r\n\r\nexport { Resources }\r\n","import * as ex from 'excalibur';\r\nimport { TiledResource } from '@excaliburjs/excalibur-tiled';\r\nimport { Isle, Item, ItemKind, buildItem } from './models';\r\nimport { Thing } from './actors/thing';\r\nimport { Resources } from './resources';\r\nimport { Player } from './actors';\r\nimport { GameConfig } from './game_config';\r\nimport { Hud } from './actors/hud';\r\n\r\ntype Entity = Item | Player\r\n\r\n// maybe goes in models??\r\nexport enum Material {\r\n    Wood = 'wood',\r\n    Stone = 'stone',\r\n}\r\n\r\ntype Stocks = { [key in Material]: number }\r\n\r\nclass World {\r\n    island: Isle\r\n    tileMap: ex.TileMap\r\n    itemKinds: { [key: string]: ItemKind }\r\n    playerCharacterMeta: { [name: string]: {\r\n        sprites: ex.SpriteSheet,\r\n        portrait: ex.Sprite,\r\n        primary: boolean\r\n    }}\r\n    debugBoxes: boolean\r\n\r\n    // craft state...\r\n    crafting: boolean\r\n    craftingItem: string\r\n    craftingAt: { x: number, y: number }\r\n\r\n    stocks: Stocks\r\n\r\n    constructor(\r\n        public scene: ex.Scene,\r\n        public hud: Hud,\r\n        public config: GameConfig,\r\n        protected engine: ex.Engine\r\n    ) {\r\n        this.island = new Isle('sorna');\r\n        this.itemKinds = {};\r\n        this.playerCharacterMeta = {\r\n            Alex: {\r\n                sprites: new ex.SpriteSheet(Resources.Alex, 4, 7, 32, 64),\r\n                portrait: Resources.AlexPortrait.asSprite(),\r\n                primary: true\r\n            },\r\n            Miranda: {\r\n                sprites: new ex.SpriteSheet(Resources.Miranda, 4, 7, 32, 64),\r\n                portrait: Resources.MirandaPortrait.asSprite(),\r\n                //portrait: Resources.AlexPortrait.asSprite,\r\n                primary: false\r\n            }\r\n        }\r\n        this.debugBoxes = config.debugBoundingBoxes;\r\n\r\n        this.stocks = {\r\n            wood: 0,\r\n            stone: 0,\r\n        }\r\n    }\r\n\r\n    enterCraftMode(itemName: string, x: number, y: number) {\r\n        this.crafting = true;\r\n        this.craftingItem = itemName;\r\n        this.craftingAt = { x, y };\r\n    }\r\n\r\n    equip(it: Item) {\r\n        if (this._primaryCharacter.equipped) {\r\n            // drop current item\r\n            this.spawn(this._primaryCharacter.equipped.kind, this.playerCell())\r\n        }\r\n        this._primaryCharacter.equip(it);\r\n        this.hud.equip(it);\r\n    }\r\n\r\n    collect(it: Item, material: Material, count: number = 1) {\r\n      console.log(\"WOULD COLLECT ITEM\", { it, material, count });\r\n      this.destroy(it);\r\n      this.stocks[material] += count;\r\n      this.hud.updateInventory(this.stocks);\r\n      console.log(\"AFTER COLLECT ITEM\", { it, material, count, stocks: this.stocks });\r\n    }\r\n\r\n    debit(material: Material, count: number = 1) {\r\n        this.stocks[material] -= count;\r\n        this.hud.updateInventory(this.stocks);\r\n    }\r\n\r\n    // need to remove it from the cell...?\r\n    //\r\n\r\n    interact(it: Entity, cell: ex.Cell): string {\r\n        if (it instanceof Item) {\r\n            // console.log(\"WOULD INTERACT WITH ITEM\", { it });\r\n            let { name, description } = it.kind;\r\n            return it.activate() || description;\r\n        } else if (it instanceof Player) {\r\n            let currentPc = this._primaryCharacter;\r\n            let message = `nice to see you again, ${currentPc.name}`;\r\n            cell['__isle_pc'] = currentPc;\r\n            currentPc.x = cell.x\r\n            currentPc.y = cell.y\r\n            currentPc.move('down');\r\n            currentPc.halt();\r\n            //cell.removeSprite(cell.sprites[1]);\r\n            // todo remove new pc from cell, add old pc TO that cell...\r\n            this.makePrimaryCharacter(it);\r\n            return message;\r\n        }\r\n    }\r\n\r\n    useItem(it: Entity, cell: ex.Cell, equipment: Item): string {\r\n        if (it instanceof Item) {\r\n            let msg = it.activate(equipment) || `use ${equipment.kind.name} on ${it.kind.name} `;\r\n            this.hud.describe(msg);\r\n            return msg;\r\n\r\n        }\r\n    }\r\n\r\n    entityAt(x: number, y: number): { entity: Entity, cell: ex.Cell } {\r\n        let cell = this.tileMap.getCellByPoint(x, y);\r\n        // console.log(\"looking for entity at \", { x, y, cell });\r\n        if (cell) {\r\n            if (cell['__isle_item']) {\r\n                let it: Item = cell['__isle_item'];\r\n                return { entity: it, cell };\r\n            } else if (cell['__isle_pc']) {\r\n                let pc: Player = cell['__isle_pc'];\r\n                return { entity: pc, cell };\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    entityNear(x: number, y: number, tol: number = 8): { entity: Entity, cell: ex.Cell} {\r\n        return this.entityAt(x, y) ||\r\n            this.entityAt(x, y + tol) ||\r\n            this.entityAt(x, y - tol) ||\r\n            this.entityAt(x - tol, y) ||\r\n            this.entityAt(x + tol, y)\r\n    }\r\n\r\n    entitiesNear(x: number, y: number, tol: number = 32): Array<{ entity: Entity, cell: ex.Cell }> {\r\n        let positions = [\r\n            {x,y},\r\n            {x, y: y + tol},\r\n            {x, y: y - tol},\r\n            {x: x - tol, y},\r\n            {x: x + tol, y}\r\n        ]\r\n\r\n        return positions\r\n            .map(pos => this.entityNear(pos.x, pos.y))\r\n            .filter(Boolean);\r\n\r\n    }\r\n\r\n    destroy(it: Item) {\r\n        console.log(\"DESTROY\", { it });\r\n        let { kind, cell } = it;\r\n        let { size } = kind;\r\n        for (const x of Array(size).keys()) {\r\n            for (const y of Array(size).keys()) {\r\n                let cellToMark = this.tileMap.getCellByIndex(cell.index + x + (y * this.tileMap.cols));\r\n                // remove item from list...\r\n                cellToMark['__isle_item'] = null;\r\n            }\r\n        }\r\n\r\n        it.actor.kill();\r\n\r\n        return true;\r\n    }\r\n\r\n    spawn(kind: ItemKind, cell: ex.Cell): Thing {\r\n        let { size } = kind;\r\n        size = size || 1;\r\n\r\n        let x = cell.x + 16 * size;\r\n        let y = cell.y + 16 * size;\r\n        let thing: Thing = new Thing(x, y, size, size, this.debugBoxes);\r\n\r\n        if (kind.drawing) {\r\n          thing.addDrawing(kind.drawing);\r\n        }\r\n\r\n        thing.constructCollisionArea(kind.collision);\r\n\r\n        let theItem: Item = buildItem(kind, thing, cell, this);\r\n        this.island.items.push(theItem);\r\n        for (const x of Array(size).keys()) {\r\n            for (const y of Array(size).keys()) {\r\n                let cellToMark = this.tileMap.getCellByIndex(cell.index + x + (y * this.tileMap.cols));\r\n                cellToMark['__isle_item'] = theItem;\r\n            }\r\n        }\r\n\r\n        this.scene.add(thing);\r\n        thing.setZIndex(thing.computeZ());\r\n        // console.log(`SPAWN ${kind.name}`, { kind, thing });\r\n        return thing;\r\n    }\r\n\r\n    _primaryCharacter: Player\r\n    createPlayableCharacter(name: string, cell: ex.Cell) { // x: number, y: number) {\r\n        let pcMeta = this.playerCharacterMeta[name];\r\n        if (pcMeta) {\r\n            let { x, y } = cell;\r\n            console.log(\"CREATE PC\", { pcMeta });\r\n            const pc = new Player(\r\n                name,\r\n                x, y,\r\n                this.config,\r\n                pcMeta.sprites,\r\n                pcMeta.portrait,\r\n                this.engine\r\n            );\r\n            pc.wireWorld(this);\r\n            this.scene.add(pc);\r\n            if (pcMeta.primary) {\r\n                this.makePrimaryCharacter(pc);\r\n            } else {\r\n                console.log(\"PC is not primary\", { pcMeta });\r\n                cell['__isle_pc'] = pc;\r\n            }\r\n        }\r\n    }\r\n\r\n    makePrimaryCharacter(pc: Player) {\r\n        console.log(\"CREATE PRIMARY PC!!!\", { pc });\r\n        this._primaryCharacter = pc;\r\n        pc.move('down');\r\n        pc.halt();\r\n        //pc.facing = 'down';\r\n        // fix cam!\r\n        this.scene.camera.strategy.lockToActor(pc);\r\n        this.scene.camera.zoom(this.config.zoom);\r\n\r\n        // tell hud\r\n        this.hud.playing(pc);\r\n    }\r\n\r\n    primaryCharacter() {\r\n        return this._primaryCharacter;\r\n    }\r\n\r\n    playerCell() {\r\n        return this.tileMap.getCellByPoint(\r\n            this._primaryCharacter.x,\r\n            this._primaryCharacter.y\r\n        )\r\n    }\r\n\r\n    processTiledMap(mapResource: TiledResource) {\r\n        let _mapRes: TiledResource = mapResource; // Resources.Map;\r\n        let terrainMeta = {};\r\n        let spriteTerrainById = {};\r\n        let spriteCollisionById = {};\r\n\r\n        let characterById = {};\r\n\r\n        let itemKindBySpriteId: { [spriteId: number]: ItemKind } = {};\r\n\r\n\r\n        _mapRes.data.tilesets.forEach((ts) => {\r\n            //console.log(\"TILESET\", { ts });\r\n            if (ts.terrains) {\r\n                ts.terrains.forEach(terrain => {\r\n                    if (terrain.properties) {\r\n                        terrainMeta[terrain.tile] = terrain.properties.reduce((acc, curr) => {\r\n                            let { name, value } = curr;\r\n                            return (<any>Object).assign(acc, { [name]: value })\r\n                        }, {});\r\n\r\n                        terrainMeta[terrain.tile].terrainName = terrain.name;\r\n\r\n                        console.log(\r\n                            `terrain ${terrain.name} (${terrain.tile}) has props: `,\r\n                            terrainMeta[terrain.tile]\r\n                        )\r\n                    }\r\n                });\r\n\r\n                spriteTerrainById = ts.tiles.reduce((acc, curr) => {\r\n                    let { terrain, id } = curr;\r\n                    const solid = terrain.every(tile => terrainMeta[tile] && terrainMeta[tile].solid); // : false);\r\n                    let terrainTile = { solid };\r\n                    // console.log(`terrain set for ${id}`, { solid }, terrain.map(tile => terrainMeta[tile]))\r\n                    return (<any>Object).assign(acc, { [id]: terrainTile });\r\n                }, {});\r\n\r\n                // console.log({ terrainMeta, spriteTerrainById });\r\n            }\r\n\r\n            // console.log({tiles: ts.tiles})\r\n            if (ts.tiles && ts.tiles.some(tile => tile.objectgroup)) {\r\n                // should also grab item/obj metadata here?\r\n                // console.log(\"todo -- extract obj group collision frame?\");\r\n                //debugger;\r\n                spriteCollisionById = ts.tiles.reduce((acc, curr) => {\r\n                    let { objectgroup, id } = curr;\r\n                    if (objectgroup && objectgroup.objects && objectgroup.objects.length) {\r\n                        return (<any>Object).assign(acc, { [id]: objectgroup.objects[0] });\r\n                    } else {\r\n                        return acc;\r\n                    }\r\n                }, {});\r\n\r\n                console.log({ spriteCollisionById });\r\n                console.log({ ts });\r\n\r\n                itemKindBySpriteId = ts.tiles.reduce((acc, curr) => {\r\n                    // debugger;\r\n                    //console.log({ curr });\r\n                    if (curr.properties && !curr.properties.some(prop => prop.name === 'character')) {\r\n                        let currMeta = curr.properties.reduce((acc, curr) => {\r\n                            let { name, value } = curr;\r\n                            return (<any>Object).assign(acc, { [name]: value })\r\n                        }, {});\r\n                        return (<any>Object).assign(acc, { [curr.id]: currMeta });\r\n                    } else {\r\n                        console.warn(\"no props for sprite with id (or maybe char?)\", { curr });\r\n                        // no props for this one?\r\n                        return acc;\r\n                    }\r\n                }, {})\r\n                //console.log({ itemKindBySpriteId })\r\n\r\n                \r\n            }\r\n\r\n            if (ts.tiles && ts.tiles.some(tile => tile.properties && tile.properties.some(prop => prop.name === 'character'))) {\r\n                // console.log('character somewhere!!');\r\n                characterById = ts.tiles.reduce((acc, curr) => {\r\n                    if (curr.properties && curr.properties.some(prop => prop.name === 'character')) {\r\n                        // console.log('char found!', { curr });\r\n                        let charProp = curr.properties.find(prop => prop.name === 'character');\r\n                        let name = charProp.value;\r\n                        return (<any>Object.assign(acc, {\r\n                            [curr.id]: name // charProp.value // curr.properties.character.name\r\n                        }));\r\n                    } else {\r\n                        return acc;\r\n                    }\r\n                }, {});\r\n                console.log({ characterById });\r\n            } else {\r\n                console.warn('no player characters in tileset!', { tiles: ts.tiles })\r\n            }\r\n        });\r\n\r\n        this.tileMap = _mapRes.getTileMap();\r\n        //this.tileMap.\r\n\r\n        // this.blockingActors = [];\r\n\r\n        this.tileMap.data.forEach((cell: ex.Cell, index) => {\r\n\r\n            if (cell.sprites[0]) {\r\n                //cell.sprites[0].\r\n                let tile = spriteTerrainById[cell.sprites[0].spriteId];\r\n                cell = Object.assign(cell, tile);\r\n                // we have another sprite, maybe a thing to build a box for?\r\n                if (cell.sprites[1]) {\r\n                    // we could use the sprite, but... also we could do something else\r\n                    // build our own sprite with z-indexes\r\n                    // better yet: spawn an entity\r\n\r\n                    let { spriteSheetKey, spriteId } = cell.sprites[1];\r\n                    cell.removeSprite(cell.sprites[1]); //hhclearSprites();\r\n                    const kind: ItemKind = itemKindBySpriteId[spriteId];\r\n                    if (!kind) {\r\n                        const characterName: string = characterById[spriteId];\r\n                        if (characterName) {\r\n                            console.log(\"WOULD CREATE PLAYABLE CHARACTER\", {characterName, cell});\r\n                            this.createPlayableCharacter(characterName, cell); // cell.x, cell.y);\r\n                        } else {\r\n                            console.warn(\"CELL has sprite with no kind or character\", { cell, itemKindBySpriteId, characterById });\r\n                        }\r\n                        return;\r\n                    } // hm\r\n                    this.itemKinds[kind.name] = kind;\r\n\r\n                    // we could get the image and attach it to an actor\r\n                    const collision = spriteCollisionById[spriteId]; //cell.sprites[1].spriteId];\r\n                    //cell.removeSprite(cell.sprites[1]);\r\n\r\n                    let sheet: ex.SpriteSheet = (<any>this.tileMap)._spriteSheets[spriteSheetKey];\r\n                    // let xOff = 16, yOff = 16;\r\n                    let size = kind.size || 1;\r\n                    //let cellsToMark = [];\r\n                    if (size > 1) {\r\n                        // xOff = 16 * size; yOff = 16 * size;\r\n                        for (const x of Array(size).keys()) {\r\n                            for (const y of Array(size).keys()) {\r\n                                let cx = x, cy = y;\r\n                                let cellToRemove = this.tileMap.getCellByIndex(index + cx + (cy * this.tileMap.cols));\r\n                                if (cellToRemove.sprites[1]) {\r\n                                    //console.log(\"REMOVE SPRITE FROM\", {x,y,cellToRemove});\r\n                                    cellToRemove.removeSprite(cellToRemove.sprites[1]);\r\n                                    //cellsToMark.push(cellToRemove);\r\n                                } else {\r\n                                    // console.warn(\"NO SPRITE TO REMOVE FROM\", { x, y, size });\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    // let z: number = (kind && kind.z) || 0;\r\n                    kind.collision = collision;\r\n                    let newSprite: ex.Sprite = sheet.getSprite(spriteId)\r\n                    kind.drawing = newSprite; \r\n\r\n                    // let thing: Thing = \r\n                    this.spawn(kind, cell);\r\n                }\r\n            }\r\n        });\r\n\r\n        // console.log({ itemKinds: this.itemKinds });\r\n    }\r\n\r\n}\r\n\r\nexport { World };","import * as ex from 'excalibur';\r\nimport { Resources } from './resources';\r\n\r\nconst basicSprites = new ex.SpriteSheet(Resources.BasicSprites, 16, 8, 32, 32);\r\n\r\nconst babyPalm = basicSprites.getSprite(0);\r\nconst palm = Resources.Palm.asSprite();\r\nconst greatPalm = Resources.GreatPalm.asSprite();\r\n\r\nconst babyOak = basicSprites.getSprite(12);\r\nconst oak = Resources.Oak.asSprite();\r\nconst greatOak = Resources.GreatOak.asSprite();\r\n\r\nconst pylon = Resources.Pylon.asSprite();\r\n\r\nconst stoneBlock = Resources.Stone.asSprite();\r\nconst greatStone = Resources.GreatStone.asSprite();\r\n\r\nconst BigCampfire = Resources.Campfire.asSprite();\r\n\r\n//new ex.Sprite(Resources.GreatPalm.once)\r\nexport const BasicSpriteMap = {\r\n    chestClosed: basicSprites.getSprite(2),\r\n    chestOpen: basicSprites.getSprite(3),\r\n\r\n    babyPalm,\r\n    palm,\r\n    greatPalm,\r\n\r\n    babyOak,\r\n    oak,\r\n    greatOak,\r\n\r\n    pylon,\r\n\r\n    // also used for crafting, so needs to be capitalized/match item name\r\n    BigCampfire,\r\n\r\n    stoneBlock, \r\n    greatStone,\r\n\r\n    // materials...\r\n    wood: basicSprites.getSprite(17), //9),\r\n    stone: basicSprites.getSprite(23), // 15),\r\n};","import * as ex from 'excalibur';\r\nimport { Game } from '../game';\r\nimport { Material } from '../world';\r\nimport { Resources } from '../resources';\r\nimport { BasicSpriteMap } from '../basic_sprites';\r\nimport { Item } from '../models';\r\nimport { Player } from '.';\r\nimport { UIActor, Actor } from 'excalibur';\r\n\r\n//class Inventory extends ex.UIActor {\r\n//    // backpack:\r\n//}\r\n// inv is complex, like it's own actor/obj tree? \r\nconst inventorySprites: { [key in Material]: ex.Sprite } = {\r\n    [Material.Wood]: BasicSpriteMap.wood,\r\n    [Material.Stone]: BasicSpriteMap.stone\r\n}\r\n\r\nclass StockLine { // extends ex.UIActor {\r\n    // spriteFont: ex.SpriteFont\r\n    label: ex.Label\r\n    constructor(\r\n        public material: Material,\r\n        public count: number,\r\n        public yOff: number,\r\n        public baseFontFamily: string,\r\n        // public spriteFont: ex.SpriteFont\r\n        ) {\r\n        //super(0, yOff * 30, 200, 20)\r\n        \r\n\r\n        this.label = new ex.Label(`${material} x ${count}`, 0, 0, baseFontFamily); // 'Helvetica', this.spriteFont)\r\n        this.label.fontSize = 12\r\n        this.label.color = ex.Color.White\r\n        //this.add(this.label)\r\n    }\r\n\r\n    draw(ctx, x: number, y: number) { // delta) {\r\n        //super.draw(ctx, delta);\r\n        let sprite = inventorySprites[this.material].clone();\r\n        sprite.scale = new ex.Vector(0.5, 0.5)\r\n        sprite.draw(ctx, x, y); // - 16, y - 16)\r\n\r\n        this.label.text = `${this.material} x ${this.count}`;\r\n        this.label.x = x + 24;\r\n        this.label.y = y + 16;\r\n        this.label.draw(ctx, 0);\r\n    }\r\n}\r\n\r\nclass Inventory extends ex.UIActor {\r\n    lineItems: { [key in Material]: StockLine }\r\n\r\n    constructor(\r\n        public x: number,\r\n        public y: number,\r\n        public fontFamily: string,\r\n        // public spriteFont: ex.SpriteFont\r\n    ) {\r\n        super(x,y,100,300);\r\n\r\n        this.lineItems = {\r\n            [Material.Wood]: new StockLine(Material.Wood, 0, 0, fontFamily), //, spriteFont),\r\n            [Material.Stone]: new StockLine(Material.Stone, 0, 1, fontFamily) //, spriteFont)\r\n        }\r\n\r\n        //Object.keys(this.lineItems).forEach(material => this.add(this.lineItems[material]));\r\n    }\r\n\r\n    setStock(stocks: {[key: string]: number}) {\r\n        Object.keys(stocks).forEach((material: Material) => {\r\n            this.lineItems[material].count = stocks[material]\r\n        });\r\n\r\n        // console.log(\"AFTER SET STOCKS\", { items: this.lineItems });\r\n    }\r\n\r\n    draw(ctx, delta) {\r\n        super.draw(ctx, delta);\r\n        Object.keys(this.lineItems).forEach(\r\n            (material: Material, index: number) =>\r\n                this.lineItems[material].draw(ctx, this.x, this.y + index * 32)\r\n        );\r\n    }\r\n}\r\n\r\nclass ActivePlayer extends ex.UIActor {\r\n    currentPlayer: ex.Label\r\n    equipped: ex.Label\r\n    playerPortrait: ex.UIActor\r\n    equipmentDrawing: ex.UIActor\r\n\r\n    constructor(public x: number, public y: number, public baseFont: string) {\r\n        super(x,y); //,64,48)\r\n\r\n        //this.add(//new Actor()\r\n\r\n        this.currentPlayer = new ex.Label('???', 0, 10, baseFont);\r\n        this.currentPlayer.color = ex.Color.White;\r\n        this.currentPlayer.fontSize = 16\r\n        //this.currentPlayer.addDrawing(player.)\r\n        this.add(this.currentPlayer)\r\n\r\n        this.equipped = new ex.Label('Equipped: NONE', 0, 124, baseFont) //, this.spriteFont);\r\n        this.equipped.color = ex.Color.White;\r\n        this.equipped.fontSize = 16\r\n        this.add(this.equipped);\r\n\r\n        this.playerPortrait = new ex.UIActor(0,10); //x,y,48,48);\r\n        // this.playerPortrait.scale = new ex.Vector(2,2);\r\n        this.add(this.playerPortrait);\r\n\r\n        this.equipmentDrawing = new ex.UIActor(0,124);\r\n        this.equipmentDrawing.scale = new ex.Vector(2,2)\r\n        this.add(this.equipmentDrawing);\r\n    }\r\n\r\n    equip(item: Item) {\r\n        if (item && item.kind) {\r\n            this.equipped.text = `${item.kind.name}`;\r\n            if (item.kind.drawing) {\r\n                this.equipmentDrawing.addDrawing(item.kind.name, item.kind.drawing);\r\n                this.equipmentDrawing.setDrawing(item.kind.name)\r\n                this.add(this.equipmentDrawing);\r\n            }\r\n        } else {\r\n            this.equipped.text = \"(no equipment)\" // `Equipped. None`;\r\n            this.remove(this.equipmentDrawing);\r\n            //this.equipmentDrawing.opacity = 0; //.setDrawing(null);\r\n        }\r\n    }\r\n\r\n    playing(player: Player) {\r\n        this.currentPlayer.text = `Playing: ${player.name}`\r\n        if (player.equipped) {\r\n            this.equip(player.equipped)\r\n        } else {\r\n            this.equip(null);\r\n        }\r\n        this.playerPortrait.addDrawing(player.name, player.portrait);\r\n        this.playerPortrait.setDrawing(player.name);\r\n        //this.currentPlayer.pos = new ex.Vector(200,200)\r\n    }\r\n}\r\n\r\n\r\nclass Hud extends ex.UIActor {\r\n    output: ex.Label\r\n    activePlayer: ActivePlayer\r\n    //currentPlayer: ex.Label\r\n    //equipped: ex.Label\r\n\r\n    inventory: Inventory //ex.UIActor\r\n    //spriteFont: ex.SpriteFont\r\n\r\n    constructor(game: Game) {\r\n        super(0, 0, game.canvasWidth, game.canvasHeight);\r\n        this.initialize(game);\r\n    }\r\n\r\n    initialize(game: Game) {\r\n        const baseFont = 'Helvetica';\r\n\r\n        this.output = new ex.Label(\r\n            '(press E to interact)',\r\n            game.canvasWidth / 2,\r\n            game.canvasHeight - 40,\r\n            baseFont,\r\n        );\r\n        this.output.color = ex.Color.White;\r\n        this.output.fontSize = 48\r\n        this.output.setWidth(game.canvasWidth);\r\n        this.output.textAlign = ex.TextAlign.Center;\r\n\r\n        const brand = new ex.Label('ISLE', 20, 60, baseFont)\r\n        brand.color = ex.Color.Azure;\r\n        brand.fontSize = 24\r\n\r\n        this.inventory = new Inventory(game.canvasWidth - 300, 50, baseFont) //, this.spriteFont) // .text = 'a bunch of stuff';\r\n\r\n        this.add(this.output);\r\n        this.add(brand);\r\n        this.add(this.inventory);\r\n\r\n        this.updateInventory({\r\n            [Material.Wood]: 0,\r\n            [Material.Stone]: 0\r\n        })\r\n\r\n        this.activePlayer = new ActivePlayer(20,70,baseFont);\r\n        this.add(this.activePlayer);\r\n        //this.currentPlayer = new ex.Label('Current Player. ???', 10, 80, baseFont);\r\n        ////this.currentPlayer.addDrawing(player.)\r\n        //this.add(this.currentPlayer)\r\n\r\n        //this.equipped = new ex.Label('Equipped. NONE', 10, 80, baseFont) //, this.spriteFont);\r\n        //this.add(this.equipped);\r\n    }\r\n\r\n    updateInventory(stocks: {[key: string]: number}) {\r\n        // console.log(\"UPDATE INV\", { stocks });\r\n        this.inventory.setStock(stocks);\r\n    }\r\n\r\n    describe(description) {\r\n      this.output.text = description;\r\n      this.output.opacity = 1;\r\n      this.output.actions.clearActions();\r\n      this.output.actions.fade(0, 4000);\r\n    }\r\n\r\n    equip(item: Item) {\r\n        this.activePlayer.equip(item);\r\n    }\r\n\r\n    playing(player: Player) {\r\n        this.activePlayer.playing(player);\r\n    }\r\n}\r\n\r\n\r\nexport { Hud };","import * as ex from 'excalibur';\nimport { clamp } from '../../util';\n\nexport class Logo extends ex.Label {\n  intensity: number;\n  constructor(x: number, y: number, message: string) {\n    super(message);\n    //this.setWidth(200);\n    this.x = x; // (game.drawWidth / 2) - 200;\n    this.y = y; // 400;\n\n    this.fontFamily = 'Arial';\n    this.fontSize = 256;\n\n    this.color = new ex.Color(255,255,255);\n    this.intensity = 150;\n    this.strobe();\n  }\n\n  strobeClamp = clamp(50, 200);\n\n  strobe = () => {\n    this.intensity = this.intensity + Math.ceil(Math.random()*16) - 8;\n    this.intensity = this.strobeClamp(this.intensity);\n    // console.log(\"strobe\", { intensity: this.intensity });\n\n    this.opacity = this.intensity / 255;\n  }\n}\n","import * as ex from 'excalibur';\r\nimport { Game } from '../../game';\r\nimport { Direction, oppositeWay, addScalarToVec, dirFromVec, angleFromDir } from '../../util';\r\nimport { Vector, Effects } from 'excalibur';\r\nimport { World } from '../../world';\r\nimport { GameConfig } from '../../game_config';\r\nimport { Item } from '../../models';\r\n\r\nexport class Player extends ex.Actor {\r\n  interacting: boolean // is querying world?\r\n  usingItem: boolean   // currently using equipped item?\r\n  usingItemTicks: number\r\n\r\n  equipped: Item\r\n\r\n  speed: number\r\n  facing: Direction\r\n  _world: World\r\n  sprites: { [key: string]: ex.Sprite }\r\n  walkSprites: { [key: string]: ex.Animation }\r\n  equipSprite: ex.Sprite\r\n\r\n  constructor(\r\n    public name: string,\r\n    public x: number,\r\n    public y: number,\r\n    protected config: GameConfig,\r\n    protected spriteSheet: ex.SpriteSheet,\r\n    public portrait: ex.Sprite,\r\n    engine: ex.Engine,\r\n  ) {\r\n    super(x, y, 32, 64);\r\n\r\n    this.collisionArea.body.useCircleCollision(6, new ex.Vector(0, 22));\r\n    this.color = new ex.Color(255, 255, 255);\r\n\r\n    this.collisionType = ex.CollisionType.Active;\r\n    this.collisionArea.recalc();\r\n    this.speed = config.playerSpeed;\r\n    this.interacting = false;\r\n    this.usingItem = false;\r\n\r\n    this.sprites = {\r\n      'down':  spriteSheet.getSprite(0),\r\n      'up':    spriteSheet.getSprite(1),\r\n      'right': spriteSheet.getSprite(2),\r\n      'left':  spriteSheet.getSprite(3),\r\n    }\r\n\r\n    let walkFrames = [1,2,3,4,5,6].map(x => x * 4)\r\n    let animRate = 125; // 100; // 50; //25;\r\n    this.walkSprites = {\r\n      'down': spriteSheet.getAnimationByIndices(\r\n        engine,\r\n        walkFrames, // [4, 8, 12, 16, 20, 24], // 1, 2, 3, 4],\r\n        animRate\r\n      ),\r\n      'up': spriteSheet.getAnimationByIndices(\r\n        engine,\r\n        walkFrames.map(x => x+1),\r\n        animRate\r\n      ),\r\n      'right': spriteSheet.getAnimationByIndices(\r\n        engine,\r\n        walkFrames.map(x => x+2),\r\n        animRate\r\n      ),\r\n      'left': spriteSheet.getAnimationByIndices(\r\n        engine,\r\n        walkFrames.map(x => x+3),\r\n        animRate\r\n      )\r\n    }\r\n\r\n    // set facing + init sprite\r\n    this.move('down');\r\n    this.halt();\r\n  }\r\n\r\n  wireWorld = (world: World) => { this._world = world; }\r\n\r\n  interact() {\r\n    let pos = this.interactionPos();\r\n    this.interacting = true;\r\n    let entityAndCell = this._world.entityNear(pos.x, pos.y)\r\n\r\n    if (entityAndCell) {\r\n      let { entity, cell } = entityAndCell;\r\n      return this._world.interact(entity, cell);\r\n    }\r\n  }\r\n\r\n  equip(it: Item) {\r\n    this.equipped = it;\r\n    this.equipSprite = it.kind.drawing.clone()\r\n    this.equipSprite.scale = new ex.Vector(1.25, 1.25)\r\n    //this.equipSprite.anchor = new ex.Vector(0,1);\r\n  }\r\n\r\n  interactUsingEquipped() {\r\n    let pos = this.interactionPos();\r\n    this.interacting = true;\r\n    let entities = this._world.entitiesNear(pos.x, pos.y)\r\n    let entitiesInteracted = [];\r\n    if (entities) {\r\n      entities.forEach(entityAndCell => {\r\n        let { entity, cell } = entityAndCell;\r\n        if (!entitiesInteracted.find(e => e === entity)) {\r\n          this._world.useItem(entity, cell, this.equipped);\r\n          entitiesInteracted.push(entity);\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  interactionPos(): { x:number, y:number }  {\r\n    let interactionPos = this.getCenter().clone();\r\n    let yOff = 20;\r\n    if (this.facing === 'up') { yOff -= 2; }\r\n    if (this.facing === 'down') { yOff -= 4; }\r\n    interactionPos.y += yOff; //this.getHeight();\r\n    interactionPos.x -= 2;\r\n    addScalarToVec(interactionPos, this.facing, 24);\r\n    return interactionPos;\r\n  }\r\n\r\n  useEquippedItem() {\r\n    // if (!this.usingItem) {\r\n      this.usingItem = true;\r\n      this.usingItemTicks = 0;\r\n      this.interactUsingEquipped();\r\n    // }\r\n  }\r\n\r\n  equipmentPos(): { x: number, y: number } {\r\n    let equipmentPos = this.getCenter().clone();\r\n    if (this.facing === 'left') {\r\n      //equipmentPos.x -= 6;\r\n      equipmentPos.y += 6;\r\n    } else {\r\n      equipmentPos.x -= 4;\r\n      equipmentPos.y += 8;\r\n    }\r\n    return equipmentPos;\r\n  }\r\n\r\n  draw(ctx: CanvasRenderingContext2D, engine) {\r\n    if (!(this.facing === 'up')) {\r\n      super.draw(ctx, engine);\r\n    }\r\n\r\n    if (this.usingItem && this.equipped && this.equipSprite) {\r\n      let littleDrawing = this.equipSprite;\r\n      let ticks = this.usingItemTicks;\r\n      if (this.facing === 'left') {\r\n        ticks = 6-ticks;\r\n        littleDrawing.flipHorizontal = true;\r\n        littleDrawing.anchor = new ex.Vector(-1, 1);\r\n      } else {\r\n        littleDrawing.flipHorizontal = false;\r\n        littleDrawing.anchor = new ex.Vector(0, 1);\r\n        if (this.facing === 'up') { ticks = ticks-4; }\r\n        if (this.facing === 'down') { ticks = ticks+6; }\r\n        //if (this.facing === 'down') { ticks = ticks-4; }\r\n      }\r\n      littleDrawing.rotation = (ticks / 3) - 1;\r\n      let equipPos = this.equipmentPos();\r\n      littleDrawing.draw(ctx, equipPos.x, equipPos.y); //this.x, this.y); //equipPos.y);\r\n    }\r\n\r\n    if ((this.facing === 'up')) {\r\n      super.draw(ctx, engine);\r\n    }\r\n\r\n    if (this.config.debugBoundingBoxes) {\r\n      this.collisionArea.debugDraw(ctx, ex.Color.Chartreuse);\r\n      if (this.interacting) {\r\n        let pos = this.interactionPos();\r\n        ctx.fillRect(pos.x, pos.y - 10, 4, 4);\r\n        ctx.fillRect(pos.x, pos.y, 4, 4);\r\n        ctx.fillRect(pos.x, pos.y + 10, 4, 4);\r\n        ctx.fillRect(pos.x - 10, pos.y, 4, 4);\r\n        ctx.fillRect(pos.x + 10, pos.y, 4, 4);\r\n      }\r\n      ctx.fillRect(this.x, this.computeZ(), 3, 3);\r\n    }\r\n  }\r\n\r\n  computeZ = () => (this.y + 24); // / 10000; //8;\r\n\r\n  halt = () => {\r\n    this.vel = new ex.Vector(0, 0);\r\n    this.currentDrawing = this.sprites[this.facing];\r\n  }\r\n\r\n  move = (direction: Direction) => {\r\n    this.facing = direction;\r\n    const step = this.speed * 32;\r\n    this.halt();\r\n    if (direction === 'left')  { this.vel.x = -step; }\r\n    if (direction === 'right') { this.vel.x = step; }\r\n    if (direction === 'up')    { this.vel.y = -step; }\r\n    if (direction === 'down')  { this.vel.y = step; }\r\n\r\n    this.currentDrawing = this.walkSprites[this.facing];\r\n    //if (Math.abs(this.vel.x + this.vel.y) < this.speed) {\r\n    //  this.halt();\r\n    //  this.currentDrawing = this.sprites[this.facing];\r\n    //}\r\n  }\r\n\r\n  update(engine, delta) {\r\n    //this.currentDrawing = this.walkSprites[this.facing];\r\n    //if (Math.abs(this.vel.x + this.vel.y) < this.speed) {\r\n    //  this.halt();\r\n    //  //this.currentDrawing = this.sprites[this.facing];\r\n    //}\r\n    super.update(engine, delta);\r\n    this.setZIndex(this.computeZ());\r\n    //console.log({z: this.getZIndex()})\r\n    if (this.usingItem) {\r\n      let itemSwingTime = 5;\r\n      this.usingItemTicks += 1;\r\n      if (this.usingItemTicks > itemSwingTime) {\r\n        this.usingItem = false;\r\n      } else {\r\n        // this.interactUsingEquipped();\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n","import { Player } from './player/player';\nimport { Logo } from './brand/logo';\nexport { Player, Logo };\n","import * as ex from 'excalibur';\r\nimport { GameConfig } from '../game_config';\r\n\r\nexport class Thing extends ex.Actor {\r\n    constructor(\r\n        public x: number,\r\n        public y: number,\r\n        public zOff: number = 0,\r\n        public size: number = 1,\r\n        public debugBoxes: boolean,\r\n    ) {\r\n        super(x, y, 32 * size, 32 * size, ex.Color.Chartreuse);\r\n    }\r\n\r\n    draw(ctx, engine) {\r\n        super.draw(ctx, engine);\r\n        if (this.debugBoxes) {\r\n            this.collisionArea.debugDraw(ctx, ex.Color.LightGray);\r\n            ctx.fillRect(this.x, this.computeZ(), 5, 5);\r\n        }\r\n    }\r\n\r\n    computeZ = () => (this.y + 4 + (this.size-1) * 16); // / 10000;\r\n    constructCollisionArea(collision) {\r\n        if (!collision) {\r\n            if (this.size > 1) {\r\n                // console.log(\"CREATE LARGE THING!!!\")\r\n                this.collisionType = ex.CollisionType.Fixed;\r\n                this.body.useBoxCollision(\r\n                    new ex.Vector(\r\n                        0, //(32 * this.size) / 2,\r\n                        (16 * this.size) - 14 \r\n                    )\r\n                )\r\n                this.setHeight((26*this.size) / 4);\r\n                this.setWidth(24*this.size);\r\n            } else {\r\n                this.collisionType = ex.CollisionType.PreventCollision;\r\n            }\r\n        }\r\n        else {\r\n            this.collisionType = ex.CollisionType.Fixed;\r\n            if (collision.ellipse) {\r\n                let center = new ex.Vector((collision.x + collision.width / 2) - 16, (collision.y + collision.height / 2) - 16);\r\n                this.body.useCircleCollision(collision.height / 2, center);\r\n            }\r\n            else if (collision.polygon) {\r\n                //console.log(\"poly\", { polygon: collision.polygon });\r\n                //debugger;\r\n                let vecs: ex.Vector[] = collision.polygon.map(({ x, y }) => new ex.Vector(x + collision.x, y + collision.y));\r\n                this.body.usePolygonCollision(vecs);\r\n            }\r\n            else {\r\n                // console.warn(\"implement collider:\", { collision });\r\n                //debugger;\r\n            }\r\n        }\r\n    }\r\n}","import * as ex from 'excalibur';\r\nimport { World, Material } from './world';\r\nimport { Cell } from 'excalibur';\r\nimport { coinflip, range } from './util';\r\nimport { BasicSpriteMap } from './basic_sprites';\r\n\r\n// item 'species' -- name + description come from tile map metadata, other things are scratch pads\r\ninterface ItemKind {\r\n    name: string\r\n    description: string\r\n    z?: number // not sure but i am thinking this can go away entirely\r\n    size?: number\r\n    drawing?: ex.Sprite\r\n    collision?: any\r\n}\r\n\r\nclass Item {\r\n    constructor(\r\n        public kind: ItemKind,\r\n        public actor: ex.Actor,\r\n        public cell: ex.Cell, // the 'root' cell (upper-left corner of large objs)\r\n        public world: World\r\n    ) {\r\n        this.initialize();\r\n    }\r\n\r\n    initialize() {}\r\n\r\n    activate(it?: Item) {\r\n        return null; //'...';\r\n    }\r\n}\r\n\r\n// tools\r\nclass Handaxe extends Item {\r\n    activate() {\r\n        this.world.equip(this);\r\n        this.world.destroy(this);\r\n        return this.kind.description;\r\n    }\r\n}\r\n\r\nclass Machete extends Item {\r\n    activate() {\r\n        this.world.equip(this);\r\n        this.world.destroy(this);\r\n        return this.kind.description;\r\n    }\r\n}\r\n\r\n// containers\r\nclass Chest extends Item {\r\n    state: { open: boolean } = { open: false }\r\n\r\n    initialize() {\r\n        this.actor.addDrawing('closed', BasicSpriteMap.chestClosed);\r\n        this.actor.addDrawing('open', BasicSpriteMap.chestOpen);\r\n        //this.actor.addDrawing();\r\n    }\r\n\r\n    activate(it: Item) {\r\n        if (!it) {\r\n            console.log(\"Chest activated!\");\r\n            if (this.state.open) {\r\n                this.actor.setDrawing('closed');\r\n                this.state = { open: false };\r\n                return 'closed';\r\n            } else {\r\n                this.actor.setDrawing('open');\r\n                this.state = { open: true }\r\n                return 'opened';\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n// doodads\r\nclass BigCampfire extends Item {\r\n    initialize() {\r\n        this.actor.addDrawing('fire', BasicSpriteMap.BigCampfire);\r\n        this.actor.setDrawing('fire');\r\n        //this.actor.setDrawing('big')\r\n    }\r\n}\r\n\r\nclass Pylon extends Item {\r\n    initialize() {\r\n        this.actor.addDrawing('pylon', BasicSpriteMap.pylon);\r\n        this.actor.setDrawing('pylon');\r\n    }\r\n}\r\n\r\n\r\n// resources ...\r\nclass StoneBlock extends Item {\r\n    initialize() {\r\n        this.actor.addDrawing('stoneblock', BasicSpriteMap.stoneBlock);\r\n        this.actor.setDrawing('stoneblock')\r\n    }\r\n}\r\n\r\nclass GreatStone extends Item {\r\n    initialize() {\r\n        this.actor.addDrawing('greatstone', BasicSpriteMap.greatStone);\r\n        this.actor.setDrawing('greatstone');\r\n    }\r\n}\r\n\r\nclass WoodLog extends Item {\r\n  activate(it: Item) {\r\n      if (!it) {\r\n          this.world.collect(this, Material.Wood);\r\n      }\r\n      return this.kind.description;\r\n    }\r\n}\r\n\r\nclass WoodLogStack extends Item {\r\n    activate(it: Item) {\r\n        if (!it) {\r\n            this.world.collect(this, Material.Wood, 3);\r\n        }\r\n        return this.kind.description;\r\n    }\r\n}\r\n\r\n\r\nclass Tree extends Item {\r\n    hitPoints: number = 100\r\n    state: { hp: number } = { hp: this.hitPoints }\r\n\r\n    protected hitBy(it: Item) {\r\n        let damage = it.kind.name === 'Handaxe' ? 25 : 0;\r\n        this.state.hp -= damage;\r\n    }\r\n\r\n    public activate(it: Item) {\r\n        if (!it) { return this.kind.description; }\r\n\r\n        this.hitBy(it);\r\n\r\n        if (this.state.hp > 0) {\r\n            const message: string = `once a seed (${this.state.hp}/${this.hitPoints})`\r\n            return message;\r\n        } else {\r\n            this.blowUp();\r\n            return \"timber\";\r\n        }\r\n    }\r\n\r\n    protected blowUp() {\r\n        let basis = this.kind.size ? (this.kind.size / 2) : 1;\r\n        console.log({ basis });\r\n        let baseCells: Array<ex.Cell> = range(-basis, basis).map((offset) => //this.cell; //world.tileMap.getCellByPoint(this.actor.x, this.actor.y);\r\n            this.world.tileMap.getCellByIndex(this.cell.index +\r\n                (this.kind.size / 2) + offset +\r\n                ((this.kind.size - 1) * this.world.tileMap.cols)));\r\n        this.world.destroy(this);\r\n        baseCells.forEach(base => {\r\n            let logKind = coinflip() ? 'WoodLogStack' : 'WoodLog';\r\n            this.world.spawn(this.world.itemKinds[logKind], base);\r\n        });\r\n    }\r\n}\r\n\r\nclass Palm extends Tree {\r\n    state: { hp: number } = { hp: 25 }\r\n    initialize() {\r\n        this.actor.addDrawing('palm', BasicSpriteMap.palm);\r\n        this.actor.setDrawing('palm');\r\n    }\r\n}\r\n\r\nclass Oak extends Tree {\r\n    state: { hp: number } = { hp: 40 }\r\n    initialize() {\r\n        this.actor.addDrawing('oak', BasicSpriteMap.oak);\r\n        this.actor.setDrawing('oak');\r\n    }\r\n}\r\n\r\nclass GreatPalm extends Tree {\r\n    initialize() {\r\n        this.actor.addDrawing('palm', BasicSpriteMap.greatPalm);\r\n        this.actor.setDrawing('palm');\r\n    }\r\n}\r\n\r\nclass GreatOak extends Tree {\r\n    initialize() {\r\n        this.actor.addDrawing('oak', BasicSpriteMap.greatOak);\r\n        this.actor.setDrawing('oak');\r\n    }\r\n}\r\n\r\nclass LittleTree extends Tree {\r\n    state: { hp: number } = { hp: 10 }\r\n    protected hitBy(it: Item) {\r\n        // only machete??\r\n        let canHit = it.kind.name === 'Machete' || it.kind.name === 'Handaxe';\r\n        let damage = canHit ? 25 : 0;\r\n        this.state.hp -= damage;\r\n    }\r\n\r\n    protected blowUp() {\r\n        // just explode, no resources\r\n        this.world.destroy(this);\r\n    }\r\n}\r\n\r\nclass BabyPalm extends LittleTree {\r\n    initialize() {\r\n        this.actor.addDrawing('palm', BasicSpriteMap.babyPalm);\r\n        this.actor.setDrawing('palm');\r\n    }   \r\n}\r\n\r\nclass BabyOak extends LittleTree {\r\n    initialize() {\r\n        this.actor.addDrawing('oak', BasicSpriteMap.babyOak);\r\n        this.actor.setDrawing('oak');\r\n    }\r\n}\r\n\r\n\r\n\r\nconst itemClasses = {\r\n    Chest,\r\n\r\n    BabyPalm,\r\n    Palm,\r\n    GreatPalm,\r\n\r\n    BabyOak,\r\n    Oak,\r\n    GreatOak,\r\n\r\n    BigCampfire,\r\n    Pylon,\r\n    WoodLog,\r\n    WoodLogStack,\r\n\r\n    StoneBlock,\r\n    GreatStone,\r\n\r\n    Handaxe,\r\n    Machete,\r\n};\r\n\r\nconst buildItem = (kind: ItemKind, actor: ex.Actor, cell: Cell, world: World): Item => {\r\n    if (itemClasses[kind.name]) {\r\n        return new itemClasses[kind.name](kind, actor, cell, world);\r\n    } else {\r\n        return new Item(kind, actor, cell, world);\r\n    }\r\n}\r\n\r\nclass Isle {\r\n    constructor(public name: string, public items: Array<Item> = []) {\r\n    }\r\n}\r\n\r\nexport { Isle, Item, ItemKind, buildItem };","import * as ex from 'excalibur';\nimport { Resources } from './resources';\nimport { GameConfig } from './game_config';\nimport { setupMaster } from 'cluster';\nimport { LevelOne } from './scenes/level-one/level-one';\nimport { Logo } from './actors';\n\nexport class Game extends ex.Engine {\n  constructor(width: number, height: number, config: GameConfig) {\n    super({ width, height, displayMode: ex.DisplayMode.FullScreen });\n\n    this.setup();\n  }\n\n\n  // entrypoint\n\n  public start() {\n    let loader = new ex.Loader();\n    for (let key in Resources) {\n      loader.addResource(Resources[key]);\n    }\n\n    //loader.backgroundColor = '#8abec0'\n    loader.logo = \"data:image/png;base64,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\";\n      // \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAQAAABOvH+BAAAFUklEQVR4nO2dS5bjIAxFcZ/aR0be/4IYeSXpAXHZ8VfCEjyodyfpU53jyOghxD8EQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEENI8Q20D0Hi90+cEWzKv9zQsdibyrYV9zRq83iHEz79HOAnMLo9hDIudiTGEkCcDsJesyeu9LVQUCSTXx7uvhTHoRQDyis+wCNtb94dQWwJLkL93/YJWBD+KZ3/4bn1syC/or7D9a5n2eUfur0Oe2xdiCGF8y99fXVC5hl0zfj51jju3RlcPzt1fKgY8dfsWud2qCOBXT5Y6LDX8WoqpHoSAnM2HsE7sbIniklQIoESYlBkui0PpG5pw6MV5o1m/4cnIAWqjE2L8zQxyhCCvSefg5BdHNCaAnBxE37zY4ZUz2dGUAJ7VpRQLSosA2/0h/KttgJznoTSGEF5vTTcWZzDIi2YEYNOSxo8IDB7VCWACOKtxlokUelC2QB65wARwjHUeHYvFgGkY779UFUUSOA2ja057NnpXrxvVfwag7AVMw3q8/RiJs45rRf+FXQqNcNXdwLtHjxfj6tJnrMEeRkFEF7eMxwHO29YS4XQfWf6WeHKWhRgLYBqOJZDrfmn9P3v146wFqW23TBJz3qrISKBvgV9N/S5ZS1x9H8n9tW2BHgqW1P/7Ikz/n79YxI/67ocWgI37Z/RFjeAef5oYCDrjb7jIl6YFQJ4DKwD2/8sAKwBShqYFUG5SxwcE+5sWAEYRtk3jAqAEngIrAPlMelQu80KivnzNJ4Nq5O7a7VBIxJsJdu+3Ah4J1FFnza8F11XGW9iwTYCe2HRjcIZ3IwEsgJz1dLMIepKBrwS6aQIW5j2BbTYIpelQAIlW9gdLsNiheAZwE/B8UXX8NAlG5nQJtABs1tX3mBraAS6AJIGnImAcOAdeACFMg1UcMDCmOxoQQAhzHHiaEVACe0x7AZ4DwdulnTlr/j2z6VZprBu4dt92ubeENiXgufaxMQGsWccELh/LpWEBJGYZ9CsB37XPzQsgId+6jtQIyJJaX2uLCKBEoadNYC3FAYxdDY10A2XYnsfh223EcH9nAmjhSBY0OhOARAIcEFrTnQAYBXQUEkDZWkcJyOkwAoRACcjpVAD4oGQiFMAFKE7ypFsBsBGQYSiA68ngv1CbdGCUSLcRoAUQJEABVKX+gtVOZgPbZd6/UGtmgAIAoKYIzJqA+/WAZVu81g6ZqrW11SACSK82Lklr7k/U2M6mvDn06K94RX3tfs1MfPn1Q8vW1gTQAREWt3aVKE7b2l9nCdnqaGuDm9GvKJwEas/x0F8Mbx/8Y9Vdxuub0T0sEAvAqmCXdu6b69uCZC7wuqfzOyzXE8LddT05tlXpBh45aR9o15K7vwha6vz8tXjfYtzjLwzB6enq5kooAP+setvWHv1iPEyOSvdCTu9EAjiTRJ+xNDYQtE+OdK73XItbe0xvtkInASABrE2XDCshsj+xcBpK71bQSQB0MshnNr/MWvztiCf2ygRQAXhQbysGsgSEAkB+BRkl3b+f9bA46MYHoBzgG9u2s3Tt37fD62t3kfIXWAFYSuDO/aUStdkKJCEACWDvJhvHSGq/983o219LnwhCEAugfHfGBmnwv74Z3efNt0KQYzXbCRQBjs1+JrurS2WPOP+ub13NuNTyQjKdjQTmBmet8++s+DxVOP7onXTaPV31IL9R97sCk8/zzZ0t76z/dSEFlMMfJGQY+jILh0vPWFJg9/KzrfVS9uuk2nF/lgBmni9gzCmoq19tqeAJIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEAP+AwVxGTrL66gaAAAAAElFTkSuQmCC\";\n    loader.logoWidth = 256;\n    loader.playButtonText = \"Let's go!\"\n    // null; // Resources.Brand;\n\n    return super.start(loader).then(this.kick);\n  }\n\n  // runs on new Game\n  protected setup() {\n    // console.log(\"game setup here\")\n    // initialize island...\n\n    // const levelOne = new LevelOne();\n    // this.add(levelOne);\n  }\n\n  // runs after loader\n  protected kick() {\n\n  } \n}\n","module.exports = __webpack_public_path__ + \"fac8210e66067d101e48370329fc4c5a.mp3\";","module.exports = __webpack_public_path__ + \"8e8aa6414e948820c3ad76cc2be5950e.png\";","module.exports = __webpack_public_path__ + \"ca373579e888b480a3018a5d8826a8ec.png\";","module.exports = __webpack_public_path__ + \"bd8b1359e881d716adaebf82ceae9547.png\";","module.exports = __webpack_public_path__ + \"a77a0c0f8e76544c35f800ad0003445e.png\";","module.exports = __webpack_public_path__ + \"be555212af12468dfc6c24525a03bc25.png\";","module.exports = __webpack_public_path__ + \"05c38280a2940f2be3e04ebed0aeb492.png\";","module.exports = __webpack_public_path__ + \"db6f4f593c47b1aa561da3453157f4bb.png\";","module.exports = __webpack_public_path__ + \"e12b440e05a78caaa8a410ac5a9ae975.png\";","module.exports = __webpack_public_path__ + \"e8f1161936c58700cbc12404b91b8085.png\";","module.exports = __webpack_public_path__ + \"4370e7e154e6bf9f7f29f94d09f57d4d.png\";","module.exports = __webpack_public_path__ + \"9ed23a06339fdd13866ae30b9487fee6.png\";","module.exports = __webpack_public_path__ + \"2a68646c6ea259ec7876244b66663310.png\";","module.exports = __webpack_public_path__ + \"e8926674752ac71cbaab394c71265d7c.png\";","module.exports = __webpack_public_path__ + \"b9b405c74e06d77b7a88f04d6d3ae5cd.png\";","module.exports = __webpack_public_path__ + \"95be6eddfa20f80a10098ddeddb5e618.png\";","module.exports = __webpack_public_path__ + \"721a1650db3d410b2328a96727466a7f.png\";","import * as ex from 'excalibur';\nimport { World } from '../../world';\nimport { BasicSpriteMap } from '../../basic_sprites';\n\nexport class LevelOne extends ex.Scene {\n  world: World\n\n  public onInitialize(engine: ex.Engine) {\n  }\n\n  public wireWorld(world: World) { this.world = world; }\n\n  public onActivate() {\n    \n  }\n\n  public onDeactivate() {\n\n  }\n\n  // public update(engine: ex.Engine, delta) {\n  //   super.update(engine, delta);\n  // }\n\n  public draw(ctx, delta) {\n    super.draw(ctx, delta);\n\n    // draw currently-crafting item...\n    //if (this.world && this.world.crafting) {\n    //  // console.log(\"TRYING TO DRAW CRAFTING ITEM\", this.world.craftingItem);\n    //  let sprite: ex.Sprite = BasicSpriteMap[this.world.craftingItem]; //.clone();\n    //  if (sprite) { //BasicSpriteMap[this.world.craftingItem])\n    //    let craftPreview = sprite.clone()\n    //    let { x, y } = this.world.craftingAt;\n    //    // console.log(\"draw crafting item at\", {x,y});\n    //    craftPreview.opacity(0.5);\n    //    craftPreview.scale = new ex.Vector(2, 2);\n\n    //    // maybe it's red if we can't do it??\n\n    //    craftPreview.draw(ctx, x, y);\n    //  }\n    //}\n  }\n}\n","import * as ex from 'excalibur';\r\nimport { LevelOne } from './scenes/level-one/level-one';\r\nimport { Resources } from './resources';\r\nimport { Game } from './game';\r\nimport { keyToDirection, Direction, mode } from './util';\r\nimport { World, Material } from './world';\r\nimport { GameConfig } from './game_config';\r\nimport { Hud } from './actors/hud';\r\nimport { BasicSpriteMap } from './basic_sprites';\r\nimport { TileMap } from 'excalibur';\r\n\r\n// Islands are either from before or for after humankind. (gd)\r\n\r\n/* \r\nDreaming of islands  whether with joy or in fear, it \r\ndoesn't matter  is dreaming of pulling away, of being already separate, far \r\nfrom any continent, of being lost and alone  or it is dreaming of starting from \r\nscratch, recreating, beginning anew. (gd)\r\n*/\r\n\r\n// An island doesn't stop being deserted simply because it is inhabited. (gd)\r\n\r\nconst config: GameConfig = {\r\n  debugCells: false,\r\n  debugBoundingBoxes: false,\r\n  zoom: 2,\r\n  playerSpeed: 6.8, //.4,\r\n  bgMusic: true\r\n}\r\n\r\n// ex.Physics.boundsPadding = config.playerSpeed * 3;\r\n// ex.Physics.collisionPasses = 2;\r\n\r\nconst game = new Game(800, 600, config);\r\nconst levelOne = new LevelOne();\r\n\r\nconst hud = new Hud(game);\r\nlevelOne.add(hud);\r\n\r\nconst world = new World(levelOne, hud, config, game);\r\nlevelOne.wireWorld(world); // hmmm\r\n\r\ngame.input.keyboard.on('press', (evt: ex.Input.KeyEvent) => {\r\n    // check for current scene?\r\n  if (game.currentScene === levelOne) {\r\n    let player = world.primaryCharacter();\r\n\r\n    let { key } = evt;\r\n    if (key === ex.Input.Keys.E) {\r\n      let interaction = player.interact();\r\n      if (interaction) {\r\n        hud.describe(interaction);\r\n      }\r\n    } else if (key === ex.Input.Keys.C) {\r\n      if (!world.crafting) {\r\n        hud.describe('would craft!');\r\n        world.enterCraftMode('BigCampfire', 0,0);\r\n      } else {\r\n        world.crafting = false;\r\n      }\r\n    } else {\r\n      // assume we're trying to move\r\n      let direction = keyToDirection(key);\r\n      if (direction) { player.move(direction); }\r\n    }\r\n  }\r\n})\r\n\r\ngame.input.keyboard.on('hold', (evt: ex.Input.KeyEvent) => {\r\n  let { key } = evt;\r\n  let direction: Direction = keyToDirection(key);\r\n  if (direction) {\r\n    let player = world.primaryCharacter();\r\n    player.move(direction);\r\n  }\r\n})\r\n\r\ngame.input.keyboard.on('release', (evt: ex.Input.KeyEvent) => {\r\n  // console.log(\"RELEASE\", { evt });\r\n  let { key } = evt;\r\n  let direction: Direction = keyToDirection(key);\r\n  if (direction) {\r\n    let player = world.primaryCharacter();\r\n    player.halt(); //direction);\r\n    player.interacting = false;\r\n  }\r\n});\r\n\r\ngame.add('wander', levelOne);\r\n\r\ngame.start().then(() => {\r\n  world.processTiledMap(Resources.Map);\r\n\r\n  let tileMap = world.tileMap;\r\n  levelOne.addTileMap(tileMap);\r\n  game.goToScene('wander');\r\n\r\n  // really should be an audio player!\r\n  if (config.bgMusic) {\r\n    let theme = Resources.FineMist; //Science;\r\n    // wait a tiny bit for music to load??? (seems to work welll)\r\n    setTimeout(() => {\r\n      // console.log('about to play music', { theme, isLoaded: theme.isLoaded() });\r\n      theme.play(0.2) //1.0)\r\n    }, 3000);\r\n  }\r\n\r\n  //game.input.pointers.primary.on('move', (e: ex.Input.PointerEvent) => {\r\n  //  // console.log(\"MOUSE MOVE\");\r\n  //  let { pos } = e;\r\n  //  if (world && world.crafting) {\r\n  //    // console.log(\"MOUSE MOVE while CRAFTING...\");\r\n  //    let cell = world.tileMap.getCellByPoint(pos.x, pos.y);\r\n  //    let x = cell.x, y = cell.y;\r\n  //    let screenPos = game.worldToScreenCoordinates(new ex.Vector(x,y));\r\n  //    //world.craftingItem = 'campfire';\r\n  //    world.craftingAt = screenPos;\r\n  //    //console.log(\"draw fire sprite at\", {x,y});\r\n  //    //fireSprite.draw(game.ctx, x, y); //cell.x * 32, cell.y * 32);\r\n  //  }\r\n  //});\r\n\r\n  game.input.pointers.primary.on('down', (e: ex.Input.PointerEvent) => {\r\n    let { pos } = e;\r\n    // console.log(\"CLICK\", { pos });\r\n    if (world && world.crafting) { // && world.ableToCraft()) {\r\n      // console.log(\"CLICK while CRAFTING\");\r\n      // hud.describe(`would build ${world.craftingItem}!`);\r\n      let kind = world.itemKinds[world.craftingItem];\r\n\r\n      let cell = world.tileMap.getCellByPoint(pos.x, pos.y);\r\n      //debugger;\r\n      world.spawn(kind, cell);\r\n      world.crafting = false;\r\n      world.debit(Material.Wood);\r\n      //world.primaryCharacter().a\r\n    } else {\r\n      if (world._primaryCharacter.equipped) {\r\n        world.primaryCharacter().useEquippedItem();\r\n      }\r\n    }\r\n  })\r\n\r\n});"],"sourceRoot":""}