{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/util.ts","webpack:///./src/resources.ts","webpack:///./src/world.ts","webpack:///./src/basic_sprites.ts","webpack:///./src/actors/hud.ts","webpack:///./src/actors/brand/logo.ts","webpack:///./src/actors/player/player.ts","webpack:///./src/actors/index.ts","webpack:///./src/actors/thing.ts","webpack:///./src/models.ts","webpack:///./src/game.ts","webpack:///./src/sounds/finemist.mp3","webpack:///./src/images/campfire.png","webpack:///./src/images/pylon.png","webpack:///./src/images/waterfall.png","webpack:///./src/images/stone-wall-12.png","webpack:///./src/images/greatstone.png","webpack:///./src/images/stone.png","webpack:///./src/images/oak.png","webpack:///./src/images/greatOak.png","webpack:///./src/images/palm.png","webpack:///./src/images/greatpalm.png","webpack:///./src/images/miranda-portrait.png","webpack:///./src/images/miranda-sprites.png","webpack:///./src/images/alex-portrait.png","webpack:///./src/images/alex-sprites.png","webpack:///./src/images/basic-sprites.png","webpack:///./src/images/spritemap.png","webpack:///./src/images/brand.png","webpack:///./src/images/alpha.png","webpack:///./src/scenes/level-one/level-one.ts","webpack:///./src/index.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","p","jsonpArray","window","webpackJsonp","oldJsonpFunction","bind","slice","ex","coinflip","Math","random","clamp","min","max","val","clamped","keyToDirection","key","direction","Input","Keys","A","Left","D","Right","S","Down","W","Up","oppositeWay","dir","opp","mode","array","map","Map","maxFreq","item","freq","has","set","addScalarToVec","vec","step","y","x","dirFromVec","abs","angleFromDir","range","start","end","Array","fill","_","idx","excalibur_tiled_1","alpha","brand","spritemap","basicSprites","alex","alexPortrait","miranda","mirandaPortrait","greatPalm","palm","greatOak","oak","stone","greatStone","stoneWallTwelve","waterfall","pylon","campfire","fineMist","Resources","Brand","Texture","Alphabet","Alex","AlexPortrait","Miranda","MirandaPortrait","Spritemap","BasicSprites","GreatPalm","Palm","Campfire","Oak","GreatOak","Stone","GreatStone","StoneWall12","Waterfall","Pylon","FineMist","Sound","imagePathAccessor","path","tileset","replace","e","t","models_1","thing_1","resources_1","actors_1","Material","Wood","World","[object Object]","scene","hud","config","engine","this","spriteCollisionById","characterById","itemKindBySpriteId","island","Isle","itemKinds","playerCharacterMeta","sprites","SpriteSheet","portrait","asSprite","primary","debugBoxes","debugBoundingBoxes","stocks","wood","itemName","crafting","craftingItem","craftingAt","it","_primaryCharacter","equipped","spawn","kind","playerCell","equip","material","count","destroy","updateInventory","cell","Item","description","activate","Player","currentPc","message","__isle_pc","move","halt","makePrimaryCharacter","equipment","msg","describe","tileMap","getCellByPoint","__isle_items","entity","tol","entityAt","pos","entityNear","filter","Boolean","size","width","console","log","keys","cellToMark","getCellByIndex","index","cols","find","actor","kill","layer","thing","Thing","drawing","addDrawing","constructCollisionArea","collision","theItem","buildItem","items","add","setZIndex","computeZ","pcMeta","pc","wireWorld","camera","strategy","lockToActor","zoom","playing","mapResource","_mapRes","terrainMeta","spriteTerrainById","tilesets","forEach","ts","terrains","terrain","properties","tile","reduce","acc","curr","assign","terrainName","tiles","id","terrainTile","solid","every","some","objectgroup","objects","prop","currMeta","warn","getTileMap","cellIndex","terrainSpriteId","spriteId","spIndex","processTileSprite","removeSprite","spriteIndex","theSprite","spriteSheetKey","characterName","createPlayableCharacter","characters","cx","cy","cellToRemove","newSprite","_spriteSheets","getSprite","babyPalm","babyOak","stoneBlock","stoneWall","BigCampfire","BasicSpriteMap","chestClosed","chestOpen","world_1","basic_sprites_1","inventorySprites","StockLine","yOff","baseFontFamily","label","Label","fontSize","color","Color","White","ctx","sprite","clone","scale","Vector","draw","text","Hud","UIActor","game","super","canvasWidth","canvasHeight","initialize","output","setWidth","textAlign","TextAlign","Center","Azure","inventory","fontFamily","lineItems","delta","activePlayer","baseFont","currentPlayer","playerPortrait","equipmentDrawing","setDrawing","remove","player","setStock","opacity","actions","clearActions","fade","util_1","Logo","strobeClamp","strobe","intensity","ceil","Actor","spriteSheet","world","_world","vel","currentDrawing","facing","speed","walkSprites","collisionArea","body","useCircleCollision","collisionType","CollisionType","Active","recalc","playerSpeed","interacting","usingItem","down","up","right","left","walkFrames","getAnimationByIndices","interactionPos","entityAndCell","interact","equipSprite","entities","entitiesNear","entitiesInteracted","useItem","getCenter","usingItemTicks","interactUsingEquipped","equipmentPos","littleDrawing","ticks","flipHorizontal","anchor","rotation","equipPos","debugDraw","Chartreuse","fillRect","update","itemSwingTime","player_1","logo_1","height","LightGray","Fixed","ellipse","center","polygon","vecs","usePolygonCollision","useBoxCollision","setHeight","Tree","hitPoints","state","hp","damage","hitBy","blowUp","basis","baseCells","offset","base","logKind","LittleTree","itemClasses","Chest","open","BabyPalm","BabyOak","useDrawing","WoodLog","collect","WoodLogStack","StoneBlock","StoneWall","Handaxe","Machete","Game","Engine","displayMode","DisplayMode","FullScreen","setup","loader","Loader","addResource","logo","logoWidth","playButtonText","then","kick","LevelOne","Scene","level_one_1","game_1","hud_1","debugCells","bgMusic","levelOne","input","keyboard","on","evt","currentScene","primaryCharacter","E","interaction","C","enterCraftMode","processTiledMap","addTileMap","goToScene","theme","setTimeout","play","pointers","debit","useEquippedItem"],"mappings":"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","file":"main.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([33,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import * as ex from 'excalibur';\n\n// tiny probability handler...\nconst coinflip = () => Math.random() > 0.5\n\n// restrain a value between a min and a max\nconst clamp = (min: number, max: number) => (val: number) => {\n  let clamped = Math.min(val, max);\n  clamped = Math.max(clamped, min);\n  return clamped;\n}\n\ntype Direction = 'left' | 'right' | 'up' | 'down';\n\nconst keyToDirection = (key: number): Direction => {\n  let direction : Direction;\n  if (key === ex.Input.Keys.A || key === ex.Input.Keys.Left) {\n    direction = 'left';\n  }\n  if (key === ex.Input.Keys.D || key === ex.Input.Keys.Right) {\n    direction = 'right';\n  }\n  if (key === ex.Input.Keys.S || key === ex.Input.Keys.Down) {\n    direction = 'down';\n  }\n  if (key === ex.Input.Keys.W || key === ex.Input.Keys.Up) {\n    direction = 'up';\n  }\n  return direction;\n}\n\nconst oppositeWay = (dir: Direction): Direction => {\n  let opp: Direction;\n  switch(dir) {\n    case 'left': opp = 'right'; break;\n    case 'right': opp = 'left'; break;\n    case 'up': opp = 'down'; break;\n    case 'down': opp = 'up'; break;\n  }\n  return opp;\n}\n\n// suggested impl from https://codereview.stackexchange.com/a/169667\nconst mode = (array) => {\n  const map = new Map(); // new Map();\n\n  let maxFreq = 0;\n  let mode;\n\n  for(const item of array) {\n    let freq = map.has(item) ? map.get(item) : 0;\n    freq++;\n\n    if(freq > maxFreq) {\n      maxFreq = freq;\n      mode = item;\n    }\n    \n    map.set(item, freq);\n  }\n\n  return mode;\n};\n\nconst addScalarToVec = (vec: ex.Vector, direction: Direction, step: number) => {\n  switch (direction) {\n    case 'up':\n      vec.y -= step;\n      break;\n    case 'down':\n      vec.y += step;\n      break;\n    case 'left':\n      vec.x -= step;\n      break;\n    case 'right':\n      vec.x += step;\n      break;\n  }\n}\n\nconst dirFromVec = (vec: ex.Vector): Direction => {\n  let {x,y} = vec;\n  if (Math.abs(x) > Math.abs(y)) {\n    return x > 0 ? 'right' : 'left';\n  } else {\n    return y > 0 ? 'down' : 'up';\n  }\n}\n\nconst angleFromDir = (dir: Direction): number => {\n   switch (dir) {\n    case 'up':\n      return 90;\n    case 'down':\n      return 270;\n    case 'left':\n      return 180;\n    case 'right':\n      return 0;\n  }\n \n}\n\nfunction range(start, end): Array<number> {\n  return Array(end - start + 1).fill(0).map((_, idx) => start + idx)\n}\n\nexport {\n  clamp,\n  Direction,\n  keyToDirection,\n  addScalarToVec,\n  dirFromVec,\n  oppositeWay,\n  mode,\n  coinflip,\n  angleFromDir,\n  range\n};\n","import * as ex from 'excalibur';\r\nimport TiledResource from '@excaliburjs/excalibur-tiled';\r\n\r\nconst alpha = require('./images/alpha.png')\r\nconst brand = require('./images/brand.png')\r\n// const sword = require('./images/sword.png');\r\nconst spritemap = require('./images/spritemap.png')\r\nconst basicSprites = require('./images/basic-sprites.png')\r\n\r\nconst alex = require('./images/alex-sprites.png')\r\nconst alexPortrait = require('./images/alex-portrait.png')\r\n\r\nconst miranda = require('./images/miranda-sprites.png')\r\nconst mirandaPortrait = require('./images/miranda-portrait.png')\r\n\r\nconst greatPalm = require('./images/greatpalm.png')\r\nconst palm = require('./images/palm.png')\r\n\r\nconst greatOak = require('./images/greatOak.png')\r\nconst oak = require('./images/oak.png')\r\n\r\nconst stone = require('./images/stone.png')\r\nconst greatStone = require('./images/greatstone.png')\r\nconst stoneWallTwelve = require('./images/stone-wall-12.png')\r\n\r\nconst waterfall = require('./images/waterfall.png')\r\n\r\nconst pylon = require('./images/pylon.png')\r\n\r\nconst campfire = require('./images/campfire.png')\r\n\r\nconst fineMist = require('./sounds/finemist.mp3')\r\n// const science = require('./sounds/science.mp3')\r\n\r\nlet mapName = 'solidity';\r\n\r\nlet Resources = {\r\n    // app logo\r\n    Brand: new ex.Texture(brand),\r\n\r\n    // spritefont\r\n    Alphabet: new ex.Texture(alpha),\r\n\r\n    // images\r\n    Alex: new ex.Texture(alex),\r\n    AlexPortrait: new ex.Texture(alexPortrait),\r\n    Miranda: new ex.Texture(miranda),\r\n    MirandaPortrait: new ex.Texture(mirandaPortrait),\r\n\r\n    //Sword: new ex.Texture(sword),\r\n    Spritemap: new ex.Texture(spritemap), // SpriteSheet(spritemap)\r\n    BasicSprites: new ex.Texture(basicSprites),\r\n    Map: new TiledResource(`map/${mapName}.json`),\r\n    GreatPalm: new ex.Texture(greatPalm),\r\n    Palm: new ex.Texture(palm),\r\n    Campfire: new ex.Texture(campfire),\r\n\r\n    Oak: new ex.Texture(oak),\r\n    GreatOak: new ex.Texture(greatOak),\r\n\r\n    Stone: new ex.Texture(stone),\r\n    GreatStone: new ex.Texture(greatStone),\r\n    StoneWall12: new ex.Texture(stoneWallTwelve),\r\n\r\n    Waterfall: new ex.Texture(waterfall),\r\n\r\n    Pylon: new ex.Texture(pylon),\r\n\r\n    // music\r\n    FineMist: new ex.Sound(fineMist),\r\n    // Science: new ex.Sound(science)\r\n}\r\n\r\nResources.Map.imagePathAccessor = (path, tileset) => {\r\n    let actualPath = path.replace(/^(?:\\.\\.\\/)+/, \"\");\r\n    // console.log(\"LOAD IMG\", { path, actualPath });\r\n    return actualPath;\r\n    // return \"/assets/\" + path;\r\n}\r\n\r\nexport { Resources }\r\n","import * as ex from 'excalibur';\r\nimport { TiledResource } from '@excaliburjs/excalibur-tiled';\r\nimport { Isle, Item, ItemKind, buildItem } from './models';\r\nimport { Thing } from './actors/thing';\r\nimport { Resources } from './resources';\r\nimport { Player } from './actors';\r\nimport { GameConfig } from './game_config';\r\nimport { Hud } from './actors/hud';\r\n\r\ntype Entity = Item | Player\r\n\r\n// type CellContents = Entity[]\r\n\r\n// maybe goes in models??\r\nexport enum Material {\r\n    Wood = 'wood',\r\n    Stone = 'stone',\r\n}\r\n\r\ntype Stocks = { [key in Material]: number }\r\n\r\nclass World {\r\n    island: Isle\r\n    tileMap: ex.TileMap\r\n    itemKinds: { [key: string]: ItemKind }\r\n    playerCharacterMeta: { [name: string]: {\r\n        sprites: ex.SpriteSheet,\r\n        portrait: ex.Sprite,\r\n        primary: boolean\r\n    }}\r\n    debugBoxes: boolean\r\n\r\n    spriteCollisionById: object = {};\r\n    characterById: object = {};\r\n    itemKindBySpriteId: { [spriteId: number]: ItemKind } = {};\r\n\r\n\r\n\r\n    // craft state...\r\n    crafting: boolean\r\n    craftingItem: string\r\n    craftingAt: { x: number, y: number }\r\n\r\n    stocks: Stocks\r\n\r\n    constructor(\r\n        public scene: ex.Scene,\r\n        public hud: Hud,\r\n        public config: GameConfig,\r\n        protected engine: ex.Engine\r\n    ) {\r\n        this.island = new Isle('sorna');\r\n        this.itemKinds = {};\r\n        this.playerCharacterMeta = {\r\n            Alex: {\r\n                sprites: new ex.SpriteSheet(Resources.Alex, 4, 7, 32, 64),\r\n                portrait: Resources.AlexPortrait.asSprite(),\r\n                primary: true\r\n            },\r\n            Miranda: {\r\n                sprites: new ex.SpriteSheet(Resources.Miranda, 4, 7, 32, 64),\r\n                portrait: Resources.MirandaPortrait.asSprite(),\r\n                primary: false\r\n            }\r\n        }\r\n        this.debugBoxes = config.debugBoundingBoxes;\r\n\r\n        this.stocks = {\r\n            wood: 0,\r\n            stone: 0,\r\n        }\r\n    }\r\n\r\n    // askYesNo(question: string): boolean {\r\n    //     //this.os\r\n    //     return false;\r\n    // }\r\n\r\n    enterCraftMode(itemName: string, x: number, y: number) {\r\n        this.crafting = true;\r\n        this.craftingItem = itemName;\r\n        this.craftingAt = { x, y };\r\n    }\r\n\r\n    equip(it: Item) {\r\n        if (this._primaryCharacter.equipped) {\r\n            // drop current item\r\n            this.spawn(this._primaryCharacter.equipped.kind, this.playerCell())\r\n        }\r\n        this._primaryCharacter.equip(it);\r\n        this.hud.equip(it);\r\n    }\r\n\r\n    collect(it: Item, material: Material, count: number = 1) {\r\n    //   console.log(\"WOULD COLLECT ITEM\", { it, material, count });\r\n      this.destroy(it);\r\n      this.stocks[material] += count;\r\n      this.hud.updateInventory(this.stocks);\r\n    //   console.log(\"AFTER COLLECT ITEM\", { it, material, count, stocks: this.stocks });\r\n    }\r\n\r\n    debit(material: Material, count: number = 1) {\r\n        this.stocks[material] -= count;\r\n        this.hud.updateInventory(this.stocks);\r\n    }\r\n\r\n    // need to remove it from the cell...?\r\n    //\r\n\r\n    interact(it: Entity, cell: ex.Cell): string {\r\n        if (it instanceof Item) {\r\n            // console.log(\"WOULD INTERACT WITH ITEM\", { it });\r\n            let { name, description } = it.kind;\r\n            return it.activate() || description;\r\n        } else if (it instanceof Player) {\r\n            let currentPc = this._primaryCharacter;\r\n            let message = `nice to see you again, ${currentPc.name}`;\r\n            cell['__isle_pc'] = currentPc;\r\n            currentPc.x = cell.x\r\n            currentPc.y = cell.y\r\n            currentPc.move('down');\r\n            currentPc.halt();\r\n            //cell.removeSprite(cell.sprites[1]);\r\n            // todo remove new pc from cell, add old pc TO that cell...\r\n            this.makePrimaryCharacter(it);\r\n            return message;\r\n        }\r\n    }\r\n\r\n    useItem(it: Entity, cell: ex.Cell, equipment: Item): string {\r\n        if (it instanceof Item) {\r\n            let msg = it.activate(equipment) || `use ${equipment.kind.name} on ${it.kind.name} `;\r\n            this.hud.describe(msg);\r\n            return msg;\r\n\r\n        }\r\n    }\r\n\r\n    entityAt(x: number, y: number): { entity: Entity, cell: ex.Cell } {\r\n        let cell = this.tileMap.getCellByPoint(x, y);\r\n        // console.log(\"looking for entity at \", { x, y, cell });\r\n        if (cell) {\r\n            if (cell['__isle_items'] && cell['__isle_items'].length) {\r\n                let it: Item = cell['__isle_items'][0]; // just hand back first for now??\r\n                return { entity: it, cell };\r\n            } else if (cell['__isle_pc']) {\r\n                let pc: Player = cell['__isle_pc'];\r\n                return { entity: pc, cell };\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    entityNear(x: number, y: number, tol: number = 8): { entity: Entity, cell: ex.Cell} {\r\n        return this.entityAt(x, y) ||\r\n            this.entityAt(x, y + tol) ||\r\n            this.entityAt(x, y - tol) ||\r\n            this.entityAt(x - tol, y) ||\r\n            this.entityAt(x + tol, y)\r\n    }\r\n\r\n    entitiesNear(x: number, y: number, tol: number = 32): Array<{ entity: Entity, cell: ex.Cell }> {\r\n        let positions = [\r\n            {x,y},\r\n            {x, y: y + tol},\r\n            {x, y: y - tol},\r\n            {x: x - tol, y},\r\n            {x: x + tol, y}\r\n        ]\r\n\r\n        return positions\r\n            .map(pos => this.entityNear(pos.x, pos.y))\r\n            .filter(Boolean);\r\n\r\n    }\r\n\r\n    destroy(it: Item) {\r\n        let { kind, cell } = it;\r\n        let { size, width } = kind;\r\n        width = width || size;\r\n        console.log(\"DESTROY\", { it, kind: it.kind.name, size, width });\r\n        for (const x of Array(width).keys()) {\r\n            for (const y of Array(size).keys()) {\r\n                let cellToMark = this.tileMap.getCellByIndex(cell.index + x + (y * this.tileMap.cols));\r\n                // todo remove item from list...\r\n                if (cellToMark['__isle_items'].find(item => it === item)) { // ==.kind === kind) {\r\n                    cellToMark['__isle_items'] = cellToMark['__isle_items'].filter(item => it !== item);\r\n                }\r\n                //cellToMark.clearSprites();\r\n                // }; // = null;\r\n\r\n                //if (cellToMark.sprites.length > 1) {\r\n                //    // console.l\r\n                //    for (let otherSprite of cellToMark.sprites) {\r\n                //        let otherSpriteId = otherSprite.spriteId;\r\n                //        let otherKind = this.itemKindBySpriteId[otherSpriteId];\r\n\r\n                //        // hmm -- could check if it's even the same kind of thing...?\r\n                //        if (otherKind === kind) {\r\n                //            cellToMark.removeSprite(otherSprite);//cellToMark.sprites[1]);\r\n                //        }\r\n                //    }\r\n                //}\r\n            }\r\n        }\r\n\r\n        it.actor.kill();\r\n\r\n        return true;\r\n    }\r\n\r\n    spawn(kind: ItemKind, cell: ex.Cell, layer: number = 0): Thing {\r\n        let { size, width } = kind;\r\n        size = size || 1;\r\n        width = width || size;\r\n\r\n        let x = cell.x + 16 * width;\r\n        let y = cell.y + 16 * size;\r\n        let thing: Thing = new Thing(x, y, width, size, layer, this.debugBoxes);\r\n\r\n        if (kind.drawing) {\r\n          thing.addDrawing(kind.drawing);\r\n        }\r\n\r\n        thing.constructCollisionArea(kind.collision);\r\n\r\n        let theItem: Item = buildItem(kind, thing, cell, this);\r\n        this.island.items.push(theItem);\r\n        for (const x of Array(width).keys()) {\r\n            for (const y of Array(size).keys()) {\r\n                let cellToMark = this.tileMap.getCellByIndex(cell.index + x + (y * this.tileMap.cols));\r\n\r\n                cellToMark['__isle_items'] = cellToMark['__isle_items'] || []; //.push(theItem);\r\n                cellToMark['__isle_items'].push(theItem);\r\n            }\r\n        }\r\n\r\n        this.scene.add(thing);\r\n        thing.setZIndex(thing.computeZ());\r\n        console.log(`SPAWN ${kind.name}`, { kind, thing });\r\n        return thing;\r\n    }\r\n\r\n    _primaryCharacter: Player\r\n    createPlayableCharacter(name: string, cell: ex.Cell) { // x: number, y: number) {\r\n        let pcMeta = this.playerCharacterMeta[name];\r\n        if (pcMeta) {\r\n            let { x, y } = cell;\r\n            // console.log(\"CREATE PC\", { pcMeta });\r\n            const pc = new Player(\r\n                name,\r\n                x, y,\r\n                this.config,\r\n                pcMeta.sprites,\r\n                pcMeta.portrait,\r\n                this.engine\r\n            );\r\n            pc.wireWorld(this);\r\n            this.scene.add(pc);\r\n            if (pcMeta.primary) {\r\n                this.makePrimaryCharacter(pc);\r\n            } else {\r\n                // console.log(\"PC is not primary\", { pcMeta });\r\n                cell['__isle_pc'] = pc;\r\n            }\r\n        }\r\n    }\r\n\r\n    makePrimaryCharacter(pc: Player) {\r\n        this._primaryCharacter = pc;\r\n        pc.move('down');\r\n        pc.halt();\r\n\r\n        // fix cam!\r\n        this.scene.camera.strategy.lockToActor(pc);\r\n        this.scene.camera.zoom(this.config.zoom);\r\n\r\n        // tell hud\r\n        this.hud.playing(pc);\r\n    }\r\n\r\n    primaryCharacter() {\r\n        return this._primaryCharacter;\r\n    }\r\n\r\n    playerCell() {\r\n        return this.tileMap.getCellByPoint(\r\n            this._primaryCharacter.x,\r\n            this._primaryCharacter.y\r\n        )\r\n    }\r\n\r\n    processTiledMap(mapResource: TiledResource) {\r\n        let _mapRes: TiledResource = mapResource;\r\n        let terrainMeta = {};\r\n        let spriteTerrainById = {};\r\n        _mapRes.data.tilesets.forEach((ts) => {\r\n            if (ts.terrains) {\r\n                ts.terrains.forEach((terrain, index) => {\r\n                    if (terrain.properties) {\r\n                        let tile = index; // terrain.tile; // terrain tiles lie?\r\n                        terrainMeta[tile] = terrain.properties.reduce((acc, curr) => {\r\n                            let { name, value } = curr;\r\n                            return (<any>Object).assign(acc, { [name]: value })\r\n                        }, {});\r\n                        terrainMeta[tile].terrainName = terrain.name;\r\n                    }\r\n                });\r\n\r\n                spriteTerrainById = ts.tiles.reduce((acc, curr) => {\r\n                    let { terrain, id } = curr;\r\n                    const solid = terrain.every(tile => terrainMeta[tile] && terrainMeta[tile].solid);\r\n                    let terrainTile = { solid };\r\n                    return (<any>Object).assign(acc, { [id]: terrainTile });\r\n                }, {});\r\n            }\r\n\r\n            if (ts.tiles && ts.tiles.some(tile => tile.objectgroup)) {\r\n                this.spriteCollisionById = ts.tiles.reduce((acc, curr) => {\r\n                    let { objectgroup, id } = curr;\r\n                    if (objectgroup && objectgroup.objects && objectgroup.objects.length) {\r\n                        return (<any>Object).assign(acc, { [id]: objectgroup.objects[0] });\r\n                    } else {\r\n                        return acc;\r\n                    }\r\n                }, {});\r\n\r\n                this.itemKindBySpriteId = ts.tiles.reduce((acc, curr) => {\r\n                    if (curr.properties && !curr.properties.some(prop => prop.name === 'character')) {\r\n                        let currMeta = curr.properties.reduce((acc, curr) => {\r\n                            let { name, value } = curr;\r\n                            return (<any>Object).assign(acc, { [name]: value })\r\n                        }, {});\r\n                        return (<any>Object).assign(acc, { [curr.id]: currMeta });\r\n                    } else {\r\n                        console.warn(\"no props for sprite with id (or maybe char?)\", { curr });\r\n                        // no props for this one?\r\n                        return acc;\r\n                    }\r\n                }, {})\r\n                \r\n            }\r\n\r\n            let hasCharacters = ts.tiles &&\r\n                ts.tiles.some(tile => tile.properties && tile.properties.some(prop => prop.name === 'character'));\r\n\r\n            if (hasCharacters) {\r\n                this.characterById = ts.tiles.reduce((acc, curr) => {\r\n                    if (curr.properties && curr.properties.some(prop => prop.name === 'character')) {\r\n                        let charProp = curr.properties.find(prop => prop.name === 'character');\r\n                        let name = charProp.value;\r\n                        return (<any>Object.assign(acc, {\r\n                            [curr.id]: name\r\n                        }));\r\n                    } else {\r\n                        return acc;\r\n                    }\r\n                }, {});\r\n            } else {\r\n                console.warn('no player characters in tileset!', { tiles: ts.tiles })\r\n            }\r\n        });\r\n\r\n        this.tileMap = _mapRes.getTileMap();\r\n\r\n        this.tileMap.data.forEach((cell: ex.Cell, cellIndex: number) => {\r\n            if (cell.sprites[0]) {\r\n                let terrainSpriteId = cell.sprites[0].spriteId;\r\n                let tile = spriteTerrainById[terrainSpriteId];\r\n                if (tile) {\r\n                    cell = Object.assign(cell, tile);\r\n                }\r\n            }\r\n\r\n            if (cell.sprites.length > 0) {\r\n                for (let spIndex = 1; spIndex < cell.sprites.length; spIndex++) {\r\n                    this.processTileSprite(cell, spIndex, cellIndex);\r\n                }\r\n\r\n                for (let spIndex = 1; spIndex < cell.sprites.length; spIndex++) {\r\n                    cell.removeSprite(cell.sprites[spIndex]);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    processTileSprite(cell: ex.Cell, spriteIndex: number, cellIndex: number) {\r\n        let theSprite = cell.sprites[spriteIndex];\r\n\r\n        let { spriteSheetKey, spriteId } = theSprite;\r\n        const kind: ItemKind = this.itemKindBySpriteId[spriteId];\r\n\r\n        if (!kind) {\r\n            const characterName: string = this.characterById[spriteId];\r\n            if (characterName) {\r\n                console.log(\"WOULD CREATE PLAYABLE CHARACTER\", { characterName, cell });\r\n                this.createPlayableCharacter(characterName, cell);\r\n            } else {\r\n                console.warn(\"CELL has sprite with no kind or character\", { cell, items: this.itemKindBySpriteId, characters: this.characterById });\r\n            }\r\n            return;\r\n        } // hm\r\n\r\n        this.itemKinds[kind.name] = kind;\r\n\r\n        let size = kind.size || 1;\r\n        let width = kind.width || kind.size;\r\n        if (size > 1) {\r\n            console.log(\"clear space for object\", { size, width })\r\n            for (const x of Array(width).keys()) {\r\n                for (const y of Array(size).keys()) {\r\n                    let cx = x, cy = y;\r\n                    let cellToRemove = this.tileMap.getCellByIndex(cellIndex + cx + (cy * this.tileMap.cols));\r\n\r\n                    for (let spIndex = 1; spIndex < cellToRemove.sprites.length; spIndex++) {\r\n                        // we basically want to remove all sprites anyway right??\r\n                        cellToRemove.removeSprite(cellToRemove.sprites[spIndex]);\r\n                    }\r\n                    //if (cellToRemove.sprites[1]) {\r\n                    //    let otherSpriteId = cellToRemove.sprites[1].spriteId;\r\n                    //    let otherKind = this.itemKindBySpriteId[otherSpriteId];\r\n                    //    // hmm -- could check if it's even the same kind of thing...?\r\n                    //    if (otherKind === kind) {\r\n\r\n                    //        cellToRemove.removeSprite(cellToRemove.sprites[1]);\r\n                    //    }\r\n                    //} else {\r\n                    //}\r\n                }\r\n            }\r\n        }\r\n\r\n        // we could get the image and attach it to an actor\r\n        const collision = this.spriteCollisionById[spriteId];\r\n        kind.collision = collision;\r\n\r\n        let sheet: ex.SpriteSheet = (<any>this.tileMap)._spriteSheets[spriteSheetKey];\r\n        let newSprite: ex.Sprite = sheet.getSprite(spriteId)\r\n        kind.drawing = newSprite;\r\n\r\n        this.spawn(kind, cell);\r\n    }\r\n\r\n}\r\n\r\nexport { World };","import * as ex from 'excalibur';\r\nimport { Resources } from './resources';\r\n\r\nconst basicSprites = new ex.SpriteSheet(Resources.BasicSprites, 16, 8, 32, 32);\r\n\r\nconst babyPalm = basicSprites.getSprite(0);\r\nconst palm = Resources.Palm.asSprite();\r\nconst greatPalm = Resources.GreatPalm.asSprite();\r\n\r\nconst babyOak = basicSprites.getSprite(12);\r\nconst oak = Resources.Oak.asSprite();\r\nconst greatOak = Resources.GreatOak.asSprite();\r\n\r\nconst pylon = Resources.Pylon.asSprite();\r\n\r\nconst stoneBlock = Resources.Stone.asSprite();\r\nconst greatStone = Resources.GreatStone.asSprite();\r\nconst stoneWall = Resources.StoneWall12.asSprite();\r\n\r\nconst waterfall = Resources.Waterfall.asSprite();\r\n\r\nconst BigCampfire = Resources.Campfire.asSprite();\r\n\r\n//new ex.Sprite(Resources.GreatPalm.once)\r\nexport const BasicSpriteMap = {\r\n    chestClosed: basicSprites.getSprite(2),\r\n    chestOpen: basicSprites.getSprite(3),\r\n\r\n    babyPalm,\r\n    palm,\r\n    greatPalm,\r\n\r\n    babyOak,\r\n    oak,\r\n    greatOak,\r\n\r\n    pylon,\r\n\r\n    // also used for crafting, so needs to be capitalized/match item name\r\n    BigCampfire,\r\n\r\n    stoneBlock, \r\n    greatStone,\r\n    stoneWall,\r\n\r\n    waterfall,\r\n\r\n    // materials...\r\n    wood: basicSprites.getSprite(17), //9),\r\n    stone: basicSprites.getSprite(23), // 15),\r\n};","import * as ex from 'excalibur';\r\nimport { Game } from '../game';\r\nimport { Material } from '../world';\r\nimport { Resources } from '../resources';\r\nimport { BasicSpriteMap } from '../basic_sprites';\r\nimport { Item } from '../models';\r\nimport { Player } from '.';\r\nimport { UIActor, Actor } from 'excalibur';\r\n\r\n//class Inventory extends ex.UIActor {\r\n//    // backpack:\r\n//}\r\n// inv is complex, like it's own actor/obj tree? \r\nconst inventorySprites: { [key in Material]: ex.Sprite } = {\r\n    [Material.Wood]: BasicSpriteMap.wood,\r\n    [Material.Stone]: BasicSpriteMap.stone\r\n}\r\n\r\nclass StockLine { // extends ex.UIActor {\r\n    // spriteFont: ex.SpriteFont\r\n    label: ex.Label\r\n    constructor(\r\n        public material: Material,\r\n        public count: number,\r\n        public yOff: number,\r\n        public baseFontFamily: string,\r\n        // public spriteFont: ex.SpriteFont\r\n        ) {\r\n        //super(0, yOff * 30, 200, 20)\r\n        \r\n\r\n        this.label = new ex.Label(`${material} x ${count}`, 0, 0, baseFontFamily); // 'Helvetica', this.spriteFont)\r\n        this.label.fontSize = 12\r\n        this.label.color = ex.Color.White\r\n        //this.add(this.label)\r\n    }\r\n\r\n    draw(ctx, x: number, y: number) { // delta) {\r\n        //super.draw(ctx, delta);\r\n        let sprite = inventorySprites[this.material].clone();\r\n        sprite.scale = new ex.Vector(0.5, 0.5)\r\n        sprite.draw(ctx, x, y); // - 16, y - 16)\r\n\r\n        this.label.text = `${this.material} x ${this.count}`;\r\n        this.label.x = x + 24;\r\n        this.label.y = y + 16;\r\n        this.label.draw(ctx, 0);\r\n    }\r\n}\r\n\r\nclass Inventory extends ex.UIActor {\r\n    lineItems: { [key in Material]: StockLine }\r\n\r\n    constructor(\r\n        public x: number,\r\n        public y: number,\r\n        public fontFamily: string,\r\n        // public spriteFont: ex.SpriteFont\r\n    ) {\r\n        super(x,y,100,300);\r\n\r\n        this.lineItems = {\r\n            [Material.Wood]: new StockLine(Material.Wood, 0, 0, fontFamily), //, spriteFont),\r\n            [Material.Stone]: new StockLine(Material.Stone, 0, 1, fontFamily) //, spriteFont)\r\n        }\r\n\r\n        //Object.keys(this.lineItems).forEach(material => this.add(this.lineItems[material]));\r\n    }\r\n\r\n    setStock(stocks: {[key: string]: number}) {\r\n        Object.keys(stocks).forEach((material: Material) => {\r\n            this.lineItems[material].count = stocks[material]\r\n        });\r\n\r\n        // console.log(\"AFTER SET STOCKS\", { items: this.lineItems });\r\n    }\r\n\r\n    draw(ctx, delta) {\r\n        super.draw(ctx, delta);\r\n        Object.keys(this.lineItems).forEach(\r\n            (material: Material, index: number) =>\r\n                this.lineItems[material].draw(ctx, this.x, this.y + index * 32)\r\n        );\r\n    }\r\n}\r\n\r\nclass ActivePlayer extends ex.UIActor {\r\n    currentPlayer: ex.Label\r\n    equipped: ex.Label\r\n    playerPortrait: ex.UIActor\r\n    equipmentDrawing: ex.UIActor\r\n\r\n    constructor(public x: number, public y: number, public baseFont: string) {\r\n        super(x,y); //,64,48)\r\n\r\n        //this.add(//new Actor()\r\n\r\n        this.currentPlayer = new ex.Label('???', 0, 10, baseFont);\r\n        this.currentPlayer.color = ex.Color.White;\r\n        this.currentPlayer.fontSize = 16\r\n        //this.currentPlayer.addDrawing(player.)\r\n        this.add(this.currentPlayer)\r\n\r\n        this.equipped = new ex.Label('Equipped: NONE', 0, 124, baseFont) //, this.spriteFont);\r\n        this.equipped.color = ex.Color.White;\r\n        this.equipped.fontSize = 16\r\n        this.add(this.equipped);\r\n\r\n        this.playerPortrait = new ex.UIActor(0,10); //x,y,48,48);\r\n        // this.playerPortrait.scale = new ex.Vector(2,2);\r\n        this.add(this.playerPortrait);\r\n\r\n        this.equipmentDrawing = new ex.UIActor(0,124);\r\n        this.equipmentDrawing.scale = new ex.Vector(2,2)\r\n        this.add(this.equipmentDrawing);\r\n    }\r\n\r\n    equip(item: Item) {\r\n        if (item && item.kind) {\r\n            this.equipped.text = `${item.kind.name}`;\r\n            if (item.kind.drawing) {\r\n                this.equipmentDrawing.addDrawing(item.kind.name, item.kind.drawing);\r\n                this.equipmentDrawing.setDrawing(item.kind.name)\r\n                this.add(this.equipmentDrawing);\r\n            }\r\n        } else {\r\n            this.equipped.text = \"(no equipment)\" // `Equipped. None`;\r\n            this.remove(this.equipmentDrawing);\r\n            //this.equipmentDrawing.opacity = 0; //.setDrawing(null);\r\n        }\r\n    }\r\n\r\n    playing(player: Player) {\r\n        this.currentPlayer.text = `Playing: ${player.name}`\r\n        if (player.equipped) {\r\n            this.equip(player.equipped)\r\n        } else {\r\n            this.equip(null);\r\n        }\r\n        this.playerPortrait.addDrawing(player.name, player.portrait);\r\n        this.playerPortrait.setDrawing(player.name);\r\n        //this.currentPlayer.pos = new ex.Vector(200,200)\r\n    }\r\n}\r\n\r\n\r\nclass Hud extends ex.UIActor {\r\n    output: ex.Label\r\n    activePlayer: ActivePlayer\r\n    //currentPlayer: ex.Label\r\n    //equipped: ex.Label\r\n\r\n    inventory: Inventory //ex.UIActor\r\n    //spriteFont: ex.SpriteFont\r\n\r\n    constructor(game: Game) {\r\n        super(0, 0, game.canvasWidth, game.canvasHeight);\r\n        this.initialize(game);\r\n    }\r\n\r\n    initialize(game: Game) {\r\n        const baseFont = 'Helvetica';\r\n\r\n        this.output = new ex.Label(\r\n            '(press E to interact)',\r\n            game.canvasWidth / 2,\r\n            game.canvasHeight - 40,\r\n            baseFont,\r\n        );\r\n        this.output.color = ex.Color.White;\r\n        this.output.fontSize = 48\r\n        this.output.setWidth(game.canvasWidth);\r\n        this.output.textAlign = ex.TextAlign.Center;\r\n\r\n        const brand = new ex.Label('ISLE', 20, 60, baseFont)\r\n        brand.color = ex.Color.Azure;\r\n        brand.fontSize = 24\r\n\r\n        this.inventory = new Inventory(game.canvasWidth - 300, 50, baseFont) //, this.spriteFont) // .text = 'a bunch of stuff';\r\n\r\n        this.add(this.output);\r\n        this.add(brand);\r\n        this.add(this.inventory);\r\n\r\n        this.updateInventory({\r\n            [Material.Wood]: 0,\r\n            [Material.Stone]: 0\r\n        })\r\n\r\n        this.activePlayer = new ActivePlayer(20,70,baseFont);\r\n        this.add(this.activePlayer);\r\n        //this.currentPlayer = new ex.Label('Current Player. ???', 10, 80, baseFont);\r\n        ////this.currentPlayer.addDrawing(player.)\r\n        //this.add(this.currentPlayer)\r\n\r\n        //this.equipped = new ex.Label('Equipped. NONE', 10, 80, baseFont) //, this.spriteFont);\r\n        //this.add(this.equipped);\r\n    }\r\n\r\n    updateInventory(stocks: {[key: string]: number}) {\r\n        // console.log(\"UPDATE INV\", { stocks });\r\n        this.inventory.setStock(stocks);\r\n    }\r\n\r\n    describe(description) {\r\n      this.output.text = description;\r\n      this.output.opacity = 1;\r\n      this.output.actions.clearActions();\r\n      this.output.actions.fade(0, 4000);\r\n    }\r\n\r\n    equip(item: Item) {\r\n        this.activePlayer.equip(item);\r\n    }\r\n\r\n    playing(player: Player) {\r\n        this.activePlayer.playing(player);\r\n    }\r\n}\r\n\r\n\r\nexport { Hud };","import * as ex from 'excalibur';\nimport { clamp } from '../../util';\n\nexport class Logo extends ex.Label {\n  intensity: number;\n  constructor(x: number, y: number, message: string) {\n    super(message);\n    //this.setWidth(200);\n    this.x = x; // (game.drawWidth / 2) - 200;\n    this.y = y; // 400;\n\n    this.fontFamily = 'Arial';\n    this.fontSize = 256;\n\n    this.color = new ex.Color(255,255,255);\n    this.intensity = 150;\n    this.strobe();\n  }\n\n  strobeClamp = clamp(50, 200);\n\n  strobe = () => {\n    this.intensity = this.intensity + Math.ceil(Math.random()*16) - 8;\n    this.intensity = this.strobeClamp(this.intensity);\n    // console.log(\"strobe\", { intensity: this.intensity });\n\n    this.opacity = this.intensity / 255;\n  }\n}\n","import * as ex from 'excalibur';\r\nimport { Game } from '../../game';\r\nimport { Direction, oppositeWay, addScalarToVec, dirFromVec, angleFromDir } from '../../util';\r\nimport { Vector, Effects } from 'excalibur';\r\nimport { World } from '../../world';\r\nimport { GameConfig } from '../../game_config';\r\nimport { Item } from '../../models';\r\n\r\nexport class Player extends ex.Actor {\r\n  interacting: boolean // is querying world?\r\n  usingItem: boolean   // currently using equipped item?\r\n  usingItemTicks: number\r\n\r\n  equipped: Item\r\n\r\n  speed: number\r\n  facing: Direction\r\n  _world: World\r\n  sprites: { [key: string]: ex.Sprite }\r\n  walkSprites: { [key: string]: ex.Animation }\r\n  equipSprite: ex.Sprite\r\n\r\n  constructor(\r\n    public name: string,\r\n    public x: number,\r\n    public y: number,\r\n    protected config: GameConfig,\r\n    protected spriteSheet: ex.SpriteSheet,\r\n    public portrait: ex.Sprite,\r\n    engine: ex.Engine,\r\n  ) {\r\n\r\n    super(x, y, 32, 64); //64);\r\n    //this.c\r\n    // this.anchor = new ex.Vector(0,48);\r\n    // this.anchor = new ex.Vector(0,8);\r\n\r\n    this.collisionArea.body.useCircleCollision(6, new ex.Vector(0, 26));\r\n    //this.collisionArea.pos\r\n    this.color = new ex.Color(255, 255, 255);\r\n\r\n    this.collisionType = ex.CollisionType.Active;\r\n    this.collisionArea.recalc();\r\n    this.speed = config.playerSpeed;\r\n    this.interacting = false;\r\n    this.usingItem = false;\r\n\r\n    this.sprites = {\r\n      'down':  spriteSheet.getSprite(0),\r\n      'up':    spriteSheet.getSprite(1),\r\n      'right': spriteSheet.getSprite(2),\r\n      'left':  spriteSheet.getSprite(3),\r\n    }\r\n\r\n    let walkFrames = [1,2,3,4,5,6].map(x => x * 4)\r\n    let animRate = 125; // 100; // 50; //25;\r\n    this.walkSprites = {\r\n      'down': spriteSheet.getAnimationByIndices(\r\n        engine,\r\n        walkFrames, // [4, 8, 12, 16, 20, 24], // 1, 2, 3, 4],\r\n        animRate\r\n      ),\r\n      'up': spriteSheet.getAnimationByIndices(\r\n        engine,\r\n        walkFrames.map(x => x+1),\r\n        animRate\r\n      ),\r\n      'right': spriteSheet.getAnimationByIndices(\r\n        engine,\r\n        walkFrames.map(x => x+2),\r\n        animRate\r\n      ),\r\n      'left': spriteSheet.getAnimationByIndices(\r\n        engine,\r\n        walkFrames.map(x => x+3),\r\n        animRate\r\n      )\r\n    }\r\n\r\n    // set facing + init sprite\r\n    this.move('down');\r\n    this.halt();\r\n  }\r\n\r\n  wireWorld = (world: World) => { this._world = world; }\r\n\r\n  interact() {\r\n    let pos = this.interactionPos();\r\n    this.interacting = true;\r\n    let entityAndCell = this._world.entityNear(pos.x, pos.y)\r\n\r\n    if (entityAndCell) {\r\n      let { entity, cell } = entityAndCell;\r\n      return this._world.interact(entity, cell);\r\n    }\r\n  }\r\n\r\n  equip(it: Item) {\r\n    this.equipped = it;\r\n    this.equipSprite = it.kind.drawing.clone()\r\n    this.equipSprite.scale = new ex.Vector(1.25, 1.25)\r\n    //this.equipSprite.anchor = new ex.Vector(0,1);\r\n  }\r\n\r\n  interactUsingEquipped() {\r\n    let pos = this.interactionPos();\r\n    this.interacting = true;\r\n    let entities = this._world.entitiesNear(pos.x, pos.y)\r\n    let entitiesInteracted = [];\r\n    if (entities) {\r\n      entities.forEach(entityAndCell => {\r\n        let { entity, cell } = entityAndCell;\r\n        if (!entitiesInteracted.find(e => e === entity)) {\r\n          this._world.useItem(entity, cell, this.equipped);\r\n          entitiesInteracted.push(entity);\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  interactionPos(): { x:number, y:number }  {\r\n    let interactionPos = this.getCenter().clone();\r\n    let yOff = 20;\r\n    if (this.facing === 'up') { yOff -= 2; }\r\n    if (this.facing === 'down') { yOff -= 4; }\r\n    interactionPos.y += yOff; //this.getHeight();\r\n    interactionPos.x -= 2;\r\n    addScalarToVec(interactionPos, this.facing, 24);\r\n    return interactionPos;\r\n  }\r\n\r\n  useEquippedItem() {\r\n    // if (!this.usingItem) {\r\n      this.usingItem = true;\r\n      this.usingItemTicks = 0;\r\n      this.interactUsingEquipped();\r\n    // }\r\n  }\r\n\r\n  equipmentPos(): { x: number, y: number } {\r\n    let equipmentPos = this.getCenter().clone();\r\n    if (this.facing === 'left') {\r\n      //equipmentPos.x -= 6;\r\n      equipmentPos.y += 6;\r\n    } else {\r\n      equipmentPos.x -= 4;\r\n      equipmentPos.y += 8;\r\n    }\r\n    return equipmentPos;\r\n  }\r\n\r\n  draw(ctx: CanvasRenderingContext2D, delta: number) { //engine) {\r\n    if (!(this.facing === 'up')) {\r\n      super.draw(ctx, delta);\r\n    }\r\n\r\n    if (this.usingItem && this.equipped && this.equipSprite) {\r\n      let littleDrawing = this.equipSprite;\r\n      let ticks = this.usingItemTicks;\r\n      if (this.facing === 'left') {\r\n        ticks = 6-ticks;\r\n        littleDrawing.flipHorizontal = true;\r\n        littleDrawing.anchor = new ex.Vector(-1, 1);\r\n      } else {\r\n        littleDrawing.flipHorizontal = false;\r\n        littleDrawing.anchor = new ex.Vector(0, 1);\r\n        if (this.facing === 'up') { ticks = ticks-4; }\r\n        // if (this.facing === 'down') { ticks = ticks+6; }\r\n        //if (this.facing === 'down') { ticks = ticks-4; }\r\n      }\r\n      littleDrawing.rotation = (ticks / 3) - 1;\r\n      let equipPos = this.equipmentPos();\r\n      littleDrawing.draw(ctx, equipPos.x, equipPos.y); //this.x, this.y); //equipPos.y);\r\n    }\r\n\r\n    if ((this.facing === 'up')) {\r\n      super.draw(ctx, delta);\r\n    }\r\n\r\n    if (this.config.debugBoundingBoxes) {\r\n      this.collisionArea.debugDraw(ctx, ex.Color.Chartreuse);\r\n      if (this.interacting) {\r\n        let pos = this.interactionPos();\r\n        ctx.fillRect(pos.x, pos.y - 10, 4, 4);\r\n        ctx.fillRect(pos.x, pos.y, 4, 4);\r\n        ctx.fillRect(pos.x, pos.y + 10, 4, 4);\r\n        ctx.fillRect(pos.x - 10, pos.y, 4, 4);\r\n        ctx.fillRect(pos.x + 10, pos.y, 4, 4);\r\n      }\r\n      ctx.fillRect(this.x, this.computeZ(), 3, 3);\r\n    }\r\n  }\r\n\r\n  computeZ = () => (this.y + 24); // / 10000; //8;\r\n\r\n  halt = () => {\r\n    this.vel = new ex.Vector(0, 0);\r\n    this.currentDrawing = this.sprites[this.facing];\r\n  }\r\n\r\n  move = (direction: Direction) => {\r\n    this.facing = direction;\r\n    const step = this.speed * 32;\r\n    this.halt();\r\n    if (direction === 'left')  { this.vel.x = -step; }\r\n    if (direction === 'right') { this.vel.x = step; }\r\n    if (direction === 'up')    { this.vel.y = -step; }\r\n    if (direction === 'down')  { this.vel.y = step; }\r\n\r\n    this.currentDrawing = this.walkSprites[this.facing];\r\n    //if (Math.abs(this.vel.x + this.vel.y) < this.speed) {\r\n    //  this.halt();\r\n    //  this.currentDrawing = this.sprites[this.facing];\r\n    //}\r\n  }\r\n\r\n  update(engine, delta) {\r\n    //this.currentDrawing = this.walkSprites[this.facing];\r\n    //if (Math.abs(this.vel.x + this.vel.y) < this.speed) {\r\n    //  this.halt();\r\n    //  //this.currentDrawing = this.sprites[this.facing];\r\n    //}\r\n    super.update(engine, delta);\r\n    this.setZIndex(this.computeZ());\r\n    //console.log({z: this.getZIndex()})\r\n    if (this.usingItem) {\r\n      let itemSwingTime = 5;\r\n      this.usingItemTicks += 1;\r\n      if (this.usingItemTicks > itemSwingTime) {\r\n        this.usingItem = false;\r\n      } else {\r\n        // this.interactUsingEquipped();\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n","import { Player } from './player/player';\nimport { Logo } from './brand/logo';\nexport { Player, Logo };\n","import * as ex from 'excalibur';\r\nimport { GameConfig } from '../game_config';\r\n\r\nexport class Thing extends ex.Actor {\r\n    constructor(\r\n        public x: number,\r\n        public y: number,\r\n        // public zOff: number = 0,\r\n        public width: number = 1,\r\n        public height: number = 1,\r\n        public layer: number = 0,\r\n        public debugBoxes: boolean,\r\n    ) {\r\n        super(x, y, 32 * width, 32 * height, ex.Color.Chartreuse);\r\n    }\r\n\r\n    draw(ctx, engine) {\r\n        super.draw(ctx, engine);\r\n        if (this.debugBoxes) {\r\n            this.collisionArea.debugDraw(ctx, ex.Color.LightGray);\r\n            ctx.fillRect(this.x, this.computeZ(), 5, 5);\r\n        }\r\n    }\r\n\r\n    computeZ = () => (this.y + 4 + (this.height-1) * 16) + this.layer; // / 10000;\r\n    constructCollisionArea(collision) {\r\n        if (!collision) {\r\n            if (this.width > 1 || this.height > 1) {\r\n                // console.log(\"CREATE LARGE THING!!!\")\r\n                this.collisionType = ex.CollisionType.Fixed;\r\n                this.body.useBoxCollision(\r\n                    new ex.Vector(\r\n                        0, //(32 * this.size) / 2,\r\n                        (16 * this.height) - 14 \r\n                    )\r\n                )\r\n                this.setHeight((26*this.height) / 4);\r\n                this.setWidth(30*this.width);\r\n            } else {\r\n                // this.collisionType = ex.CollisionType.PreventCollision;\r\n                this.collisionType = ex.CollisionType.Fixed;\r\n            }\r\n        }\r\n        else {\r\n            this.collisionType = ex.CollisionType.Fixed;\r\n            if (collision.ellipse) {\r\n                let center = new ex.Vector((collision.x + collision.width / 2) - 16, (collision.y + collision.height / 2) - 16);\r\n                this.body.useCircleCollision(collision.height / 2, center);\r\n            }\r\n            else if (collision.polygon) {\r\n                //console.log(\"poly\", { polygon: collision.polygon });\r\n                //debugger;\r\n                let vecs: ex.Vector[] = collision.polygon.map(({ x, y }) => new ex.Vector(x + collision.x, y + collision.y));\r\n                this.body.usePolygonCollision(vecs);\r\n            }\r\n            else {\r\n                // console.warn(\"implement collider:\", { collision });\r\n                //debugger;\r\n            }\r\n        }\r\n    }\r\n}","import * as ex from 'excalibur';\r\nimport { World, Material } from './world';\r\nimport { Cell } from 'excalibur';\r\nimport { coinflip, range } from './util';\r\nimport { BasicSpriteMap } from './basic_sprites';\r\n\r\n// item 'species' -- name + description come from tile map metadata, other things are scratch pads\r\ninterface ItemKind {\r\n    name: string\r\n    description: string\r\n    z?: number // not sure but i am thinking this can go away entirely\r\n    drawing?: ex.Sprite\r\n    collision?: any\r\n    \r\n    size?: number\r\n    width?: number // override size for long horizontal things...\r\n}\r\n\r\nclass Item {\r\n    constructor(\r\n        public kind: ItemKind,\r\n        public actor: ex.Actor,\r\n        public cell: ex.Cell, // the 'root' cell (upper-left corner of large objs)\r\n        public world: World\r\n    ) {\r\n        this.initialize();\r\n    }\r\n\r\n    initialize() {}\r\n\r\n    activate(it?: Item) {\r\n        return null; //'...';\r\n    }\r\n\r\n    useDrawing(sprite: ex.Sprite) {\r\n        this.actor.addDrawing('static-image', sprite);\r\n        this.actor.setDrawing('static-image');\r\n    }\r\n}\r\n\r\n// tools\r\nclass Handaxe extends Item {\r\n    activate() {\r\n        this.world.equip(this);\r\n        this.world.destroy(this);\r\n        return this.kind.description;\r\n    }\r\n}\r\n\r\nclass Machete extends Item {\r\n    activate() {\r\n        this.world.equip(this);\r\n        this.world.destroy(this);\r\n        return this.kind.description;\r\n    }\r\n}\r\n\r\n// containers\r\nclass Chest extends Item {\r\n    state: { open: boolean } = { open: false }\r\n\r\n    initialize() {\r\n        this.actor.addDrawing('closed', BasicSpriteMap.chestClosed);\r\n        this.actor.addDrawing('open', BasicSpriteMap.chestOpen);\r\n        //this.actor.addDrawing();\r\n    }\r\n\r\n    activate(it: Item) {\r\n        if (!it) {\r\n            console.log(\"Chest activated!\");\r\n            if (this.state.open) {\r\n                this.actor.setDrawing('closed');\r\n                this.state = { open: false };\r\n                return 'closed';\r\n            } else {\r\n                this.actor.setDrawing('open');\r\n                this.state = { open: true }\r\n                return 'opened';\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n// doodads\r\nclass BigCampfire extends Item {\r\n    initialize() {\r\n        this.useDrawing(BasicSpriteMap.BigCampfire);\r\n    }\r\n}\r\n\r\nclass Pylon extends Item {\r\n    initialize() {\r\n        this.useDrawing(BasicSpriteMap.pylon);\r\n    }\r\n}\r\n\r\n\r\n// resources ...\r\nclass StoneBlock extends Item {\r\n    initialize() {\r\n        this.useDrawing(BasicSpriteMap.stoneBlock);\r\n    }\r\n}\r\n\r\nclass GreatStone extends Item {\r\n    initialize() {\r\n        this.useDrawing(BasicSpriteMap.greatStone);\r\n    }\r\n}\r\n\r\nclass WoodLog extends Item {\r\n  activate(it: Item) {\r\n      if (!it) {\r\n          this.world.collect(this, Material.Wood);\r\n      }\r\n      return this.kind.description;\r\n    }\r\n}\r\n\r\nclass WoodLogStack extends Item {\r\n    activate(it: Item) {\r\n        if (!it) {\r\n            this.world.collect(this, Material.Wood, 3);\r\n        }\r\n        return this.kind.description;\r\n    }\r\n}\r\n\r\n\r\nclass Tree extends Item {\r\n    hitPoints: number = 100\r\n    state: { hp: number } = { hp: this.hitPoints }\r\n\r\n    protected hitBy(it: Item) {\r\n        let damage = it.kind.name === 'Handaxe' ? 25 : 0;\r\n        this.state.hp -= damage;\r\n    }\r\n\r\n    public activate(it: Item) {\r\n        if (!it) { return this.kind.description; }\r\n\r\n        this.hitBy(it);\r\n\r\n        if (this.state.hp > 0) {\r\n            const message: string = `once a seed (${this.state.hp}/${this.hitPoints})`\r\n            return message;\r\n        } else {\r\n            this.blowUp();\r\n            return \"timber\";\r\n        }\r\n    }\r\n\r\n    protected blowUp() {\r\n        let basis = this.kind.size ? (this.kind.size / 2) : 1;\r\n        console.log({ basis });\r\n        let baseCells: Array<ex.Cell> = range(-basis, basis).map((offset) => //this.cell; //world.tileMap.getCellByPoint(this.actor.x, this.actor.y);\r\n            this.world.tileMap.getCellByIndex(this.cell.index +\r\n                (this.kind.size / 2) + offset +\r\n                ((this.kind.size - 1) * this.world.tileMap.cols)));\r\n        this.world.destroy(this);\r\n        baseCells.forEach(base => {\r\n            let logKind = coinflip() ? 'WoodLogStack' : 'WoodLog';\r\n            this.world.spawn(this.world.itemKinds[logKind], base);\r\n        });\r\n    }\r\n}\r\n\r\nclass Palm extends Tree {\r\n    state: { hp: number } = { hp: 25 }\r\n    initialize() {\r\n        this.actor.addDrawing('palm', BasicSpriteMap.palm);\r\n        this.actor.setDrawing('palm');\r\n    }\r\n}\r\n\r\nclass Oak extends Tree {\r\n    state: { hp: number } = { hp: 40 }\r\n    initialize() {\r\n        this.actor.addDrawing('oak', BasicSpriteMap.oak);\r\n        this.actor.setDrawing('oak');\r\n    }\r\n}\r\n\r\nclass GreatPalm extends Tree {\r\n    initialize() {\r\n        this.actor.addDrawing('palm', BasicSpriteMap.greatPalm);\r\n        this.actor.setDrawing('palm');\r\n    }\r\n}\r\n\r\nclass GreatOak extends Tree {\r\n    initialize() {\r\n        this.actor.addDrawing('oak', BasicSpriteMap.greatOak);\r\n        this.actor.setDrawing('oak');\r\n    }\r\n}\r\n\r\nclass LittleTree extends Tree {\r\n    state: { hp: number } = { hp: 10 }\r\n    protected hitBy(it: Item) {\r\n        // only machete??\r\n        let canHit = it.kind.name === 'Machete' || it.kind.name === 'Handaxe';\r\n        let damage = canHit ? 25 : 0;\r\n        this.state.hp -= damage;\r\n    }\r\n\r\n    protected blowUp() {\r\n        // just explode, no resources\r\n        this.world.destroy(this);\r\n    }\r\n}\r\n\r\nclass BabyPalm extends LittleTree {\r\n    initialize() {\r\n        this.actor.addDrawing('palm', BasicSpriteMap.babyPalm);\r\n        this.actor.setDrawing('palm');\r\n    }   \r\n}\r\n\r\nclass BabyOak extends LittleTree {\r\n    initialize() {\r\n        this.actor.addDrawing('oak', BasicSpriteMap.babyOak);\r\n        this.actor.setDrawing('oak');\r\n    }\r\n}\r\n\r\nclass StoneWall extends Item {\r\n    initialize() {\r\n        this.actor.addDrawing('stonewall', BasicSpriteMap.stoneWall);\r\n        this.actor.setDrawing('stonewall');\r\n    }\r\n}\r\n\r\nclass Waterfall extends Item {\r\n    initialize() {\r\n        this.actor.addDrawing('waterfall', BasicSpriteMap.waterfall);\r\n        this.actor.setDrawing('waterfall');\r\n    }\r\n}\r\n\r\nconst itemClasses = {\r\n    Chest,\r\n\r\n    BabyPalm,\r\n    Palm,\r\n    GreatPalm,\r\n\r\n    BabyOak,\r\n    Oak,\r\n    GreatOak,\r\n\r\n    BigCampfire,\r\n    Pylon,\r\n    WoodLog,\r\n    WoodLogStack,\r\n\r\n    StoneBlock,\r\n    GreatStone,\r\n    StoneWall,\r\n\r\n    Waterfall,\r\n\r\n    Handaxe,\r\n    Machete,\r\n};\r\n\r\nconst buildItem = (kind: ItemKind, actor: ex.Actor, cell: Cell, world: World): Item => {\r\n    if (itemClasses[kind.name]) {\r\n        return new itemClasses[kind.name](kind, actor, cell, world);\r\n    } else {\r\n        return new Item(kind, actor, cell, world);\r\n    }\r\n}\r\n\r\nclass Isle {\r\n    constructor(public name: string, public items: Array<Item> = []) {\r\n    }\r\n}\r\n\r\nexport { Isle, Item, ItemKind, buildItem };","import * as ex from 'excalibur';\nimport { Resources } from './resources';\nimport { GameConfig } from './game_config';\nimport { setupMaster } from 'cluster';\nimport { LevelOne } from './scenes/level-one/level-one';\nimport { Logo } from './actors';\n\nexport class Game extends ex.Engine {\n  constructor(width: number, height: number, config: GameConfig) {\n    super({ width, height, displayMode: ex.DisplayMode.FullScreen });\n\n    this.setup();\n  }\n\n\n  // entrypoint\n\n  public start() {\n    let loader = new ex.Loader();\n    for (let key in Resources) {\n      loader.addResource(Resources[key]);\n    }\n\n    //loader.backgroundColor = '#8abec0'\n    loader.logo = \"data:image/png;base64,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\";\n      // \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAQAAABOvH+BAAAFUklEQVR4nO2dS5bjIAxFcZ/aR0be/4IYeSXpAXHZ8VfCEjyodyfpU53jyOghxD8EQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEENI8Q20D0Hi90+cEWzKv9zQsdibyrYV9zRq83iHEz79HOAnMLo9hDIudiTGEkCcDsJesyeu9LVQUCSTXx7uvhTHoRQDyis+wCNtb94dQWwJLkL93/YJWBD+KZ3/4bn1syC/or7D9a5n2eUfur0Oe2xdiCGF8y99fXVC5hl0zfj51jju3RlcPzt1fKgY8dfsWud2qCOBXT5Y6LDX8WoqpHoSAnM2HsE7sbIniklQIoESYlBkui0PpG5pw6MV5o1m/4cnIAWqjE2L8zQxyhCCvSefg5BdHNCaAnBxE37zY4ZUz2dGUAJ7VpRQLSosA2/0h/KttgJznoTSGEF5vTTcWZzDIi2YEYNOSxo8IDB7VCWACOKtxlokUelC2QB65wARwjHUeHYvFgGkY779UFUUSOA2ja057NnpXrxvVfwag7AVMw3q8/RiJs45rRf+FXQqNcNXdwLtHjxfj6tJnrMEeRkFEF7eMxwHO29YS4XQfWf6WeHKWhRgLYBqOJZDrfmn9P3v146wFqW23TBJz3qrISKBvgV9N/S5ZS1x9H8n9tW2BHgqW1P/7Ikz/n79YxI/67ocWgI37Z/RFjeAef5oYCDrjb7jIl6YFQJ4DKwD2/8sAKwBShqYFUG5SxwcE+5sWAEYRtk3jAqAEngIrAPlMelQu80KivnzNJ4Nq5O7a7VBIxJsJdu+3Ah4J1FFnza8F11XGW9iwTYCe2HRjcIZ3IwEsgJz1dLMIepKBrwS6aQIW5j2BbTYIpelQAIlW9gdLsNiheAZwE/B8UXX8NAlG5nQJtABs1tX3mBraAS6AJIGnImAcOAdeACFMg1UcMDCmOxoQQAhzHHiaEVACe0x7AZ4DwdulnTlr/j2z6VZprBu4dt92ubeENiXgufaxMQGsWccELh/LpWEBJGYZ9CsB37XPzQsgId+6jtQIyJJaX2uLCKBEoadNYC3FAYxdDY10A2XYnsfh223EcH9nAmjhSBY0OhOARAIcEFrTnQAYBXQUEkDZWkcJyOkwAoRACcjpVAD4oGQiFMAFKE7ypFsBsBGQYSiA68ngv1CbdGCUSLcRoAUQJEABVKX+gtVOZgPbZd6/UGtmgAIAoKYIzJqA+/WAZVu81g6ZqrW11SACSK82Lklr7k/U2M6mvDn06K94RX3tfs1MfPn1Q8vW1gTQAREWt3aVKE7b2l9nCdnqaGuDm9GvKJwEas/x0F8Mbx/8Y9Vdxuub0T0sEAvAqmCXdu6b69uCZC7wuqfzOyzXE8LddT05tlXpBh45aR9o15K7vwha6vz8tXjfYtzjLwzB6enq5kooAP+setvWHv1iPEyOSvdCTu9EAjiTRJ+xNDYQtE+OdK73XItbe0xvtkInASABrE2XDCshsj+xcBpK71bQSQB0MshnNr/MWvztiCf2ygRQAXhQbysGsgSEAkB+BRkl3b+f9bA46MYHoBzgG9u2s3Tt37fD62t3kfIXWAFYSuDO/aUStdkKJCEACWDvJhvHSGq/983o219LnwhCEAugfHfGBmnwv74Z3efNt0KQYzXbCRQBjs1+JrurS2WPOP+ub13NuNTyQjKdjQTmBmet8++s+DxVOP7onXTaPV31IL9R97sCk8/zzZ0t76z/dSEFlMMfJGQY+jILh0vPWFJg9/KzrfVS9uuk2nF/lgBmni9gzCmoq19tqeAJIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEAP+AwVxGTrL66gaAAAAAElFTkSuQmCC\";\n    loader.logoWidth = 256;\n    loader.playButtonText = \"Let's go!\"\n    // null; // Resources.Brand;\n\n    return super.start(loader).then(this.kick);\n  }\n\n  // runs on new Game\n  protected setup() {\n    // console.log(\"game setup here\")\n    // initialize island...\n\n    // const levelOne = new LevelOne();\n    // this.add(levelOne);\n  }\n\n  // runs after loader\n  protected kick() {\n\n  } \n}\n","module.exports = __webpack_public_path__ + \"fac8210e66067d101e48370329fc4c5a.mp3\";","module.exports = __webpack_public_path__ + \"8e8aa6414e948820c3ad76cc2be5950e.png\";","module.exports = __webpack_public_path__ + \"ca373579e888b480a3018a5d8826a8ec.png\";","module.exports = __webpack_public_path__ + \"9f0eef41f745c74d9d81000f9644e083.png\";","module.exports = __webpack_public_path__ + \"5b2bd5c62a1802853d1429a515613846.png\";","module.exports = __webpack_public_path__ + \"bd8b1359e881d716adaebf82ceae9547.png\";","module.exports = __webpack_public_path__ + \"a77a0c0f8e76544c35f800ad0003445e.png\";","module.exports = __webpack_public_path__ + \"be555212af12468dfc6c24525a03bc25.png\";","module.exports = __webpack_public_path__ + \"05c38280a2940f2be3e04ebed0aeb492.png\";","module.exports = __webpack_public_path__ + \"db6f4f593c47b1aa561da3453157f4bb.png\";","module.exports = __webpack_public_path__ + \"e12b440e05a78caaa8a410ac5a9ae975.png\";","module.exports = __webpack_public_path__ + \"e8f1161936c58700cbc12404b91b8085.png\";","module.exports = __webpack_public_path__ + \"4370e7e154e6bf9f7f29f94d09f57d4d.png\";","module.exports = __webpack_public_path__ + \"9ed23a06339fdd13866ae30b9487fee6.png\";","module.exports = __webpack_public_path__ + \"2a68646c6ea259ec7876244b66663310.png\";","module.exports = __webpack_public_path__ + \"66c455d11f7b74080484823f2ed73f12.png\";","module.exports = __webpack_public_path__ + \"b9b405c74e06d77b7a88f04d6d3ae5cd.png\";","module.exports = __webpack_public_path__ + \"95be6eddfa20f80a10098ddeddb5e618.png\";","module.exports = __webpack_public_path__ + \"721a1650db3d410b2328a96727466a7f.png\";","import * as ex from 'excalibur';\nimport { World } from '../../world';\nimport { BasicSpriteMap } from '../../basic_sprites';\n\nexport class LevelOne extends ex.Scene {\n  world: World\n\n  public onInitialize(engine: ex.Engine) {\n  }\n\n  public wireWorld(world: World) { this.world = world; }\n\n  public onActivate() {\n    \n  }\n\n  public onDeactivate() {\n\n  }\n\n  // public update(engine: ex.Engine, delta) {\n  //   super.update(engine, delta);\n  // }\n\n  public draw(ctx, delta) {\n    super.draw(ctx, delta);\n\n    // draw currently-crafting item...\n    //if (this.world && this.world.crafting) {\n    //  // console.log(\"TRYING TO DRAW CRAFTING ITEM\", this.world.craftingItem);\n    //  let sprite: ex.Sprite = BasicSpriteMap[this.world.craftingItem]; //.clone();\n    //  if (sprite) { //BasicSpriteMap[this.world.craftingItem])\n    //    let craftPreview = sprite.clone()\n    //    let { x, y } = this.world.craftingAt;\n    //    // console.log(\"draw crafting item at\", {x,y});\n    //    craftPreview.opacity(0.5);\n    //    craftPreview.scale = new ex.Vector(2, 2);\n\n    //    // maybe it's red if we can't do it??\n\n    //    craftPreview.draw(ctx, x, y);\n    //  }\n    //}\n  }\n}\n","import * as ex from 'excalibur';\r\nimport { LevelOne } from './scenes/level-one/level-one';\r\nimport { Resources } from './resources';\r\nimport { Game } from './game';\r\nimport { keyToDirection, Direction, mode } from './util';\r\nimport { World, Material } from './world';\r\nimport { GameConfig } from './game_config';\r\nimport { Hud } from './actors/hud';\r\nimport { BasicSpriteMap } from './basic_sprites';\r\nimport { TileMap } from 'excalibur';\r\n\r\n// Islands are either from before or for after humankind. (gd)\r\n\r\n/* \r\nDreaming of islands  whether with joy or in fear, it \r\ndoesn't matter  is dreaming of pulling away, of being already separate, far \r\nfrom any continent, of being lost and alone  or it is dreaming of starting from \r\nscratch, recreating, beginning anew. (gd)\r\n*/\r\n\r\n// An island doesn't stop being deserted simply because it is inhabited. (gd)\r\n\r\nconst config: GameConfig = {\r\n  debugCells: false,\r\n  debugBoundingBoxes: false,\r\n  zoom: 3,\r\n  playerSpeed: 4.7, // 5.8, //.4,\r\n  bgMusic: true\r\n}\r\n\r\n// ex.Physics.boundsPadding = config.playerSpeed * 3;\r\n// ex.Physics.collisionPasses = 2;\r\n\r\nconst game = new Game(800, 600, config);\r\nconst levelOne = new LevelOne();\r\n\r\nconst hud = new Hud(game);\r\nlevelOne.add(hud);\r\n\r\nconst world = new World(levelOne, hud, config, game);\r\nlevelOne.wireWorld(world); // hmmm\r\n\r\ngame.input.keyboard.on('press', (evt: ex.Input.KeyEvent) => {\r\n    // check for current scene?\r\n  if (game.currentScene === levelOne) {\r\n    let player = world.primaryCharacter();\r\n\r\n    let { key } = evt;\r\n    if (key === ex.Input.Keys.E) {\r\n      let interaction = player.interact();\r\n      if (interaction) {\r\n        hud.describe(interaction);\r\n      }\r\n    } else if (key === ex.Input.Keys.C) {\r\n      if (!world.crafting) {\r\n        hud.describe('would craft!');\r\n        world.enterCraftMode('BigCampfire', 0,0);\r\n      } else {\r\n        world.crafting = false;\r\n      }\r\n    } else {\r\n      // assume we're trying to move\r\n      let direction = keyToDirection(key);\r\n      if (direction) { player.move(direction); }\r\n    }\r\n  }\r\n})\r\n\r\ngame.input.keyboard.on('hold', (evt: ex.Input.KeyEvent) => {\r\n  let { key } = evt;\r\n  let direction: Direction = keyToDirection(key);\r\n  if (direction) {\r\n    let player = world.primaryCharacter();\r\n    player.move(direction);\r\n  }\r\n})\r\n\r\ngame.input.keyboard.on('release', (evt: ex.Input.KeyEvent) => {\r\n  // console.log(\"RELEASE\", { evt });\r\n  let { key } = evt;\r\n  let direction: Direction = keyToDirection(key);\r\n  if (direction) {\r\n    let player = world.primaryCharacter();\r\n    player.halt(); //direction);\r\n    player.interacting = false;\r\n  }\r\n});\r\n\r\ngame.add('wander', levelOne);\r\n\r\ngame.start().then(() => {\r\n  world.processTiledMap(Resources.Map);\r\n\r\n  let tileMap = world.tileMap;\r\n  levelOne.addTileMap(tileMap);\r\n  game.goToScene('wander');\r\n\r\n  // really should be an audio player!\r\n  if (config.bgMusic) {\r\n    let theme = Resources.FineMist; //Science;\r\n    // wait a tiny bit for music to load??? (seems to work welll)\r\n    setTimeout(() => {\r\n      // console.log('about to play music', { theme, isLoaded: theme.isLoaded() });\r\n      theme.play(0.2) //1.0)\r\n    }, 3000);\r\n  }\r\n\r\n  // game.input.pointers.primary.on('move', (e: ex.Input.PointerEvent) => {\r\n  // //  // console.log(\"MOUSE MOVE\");\r\n  //  let { pos } = e;\r\n  //  if (world && world.tileMap) {\r\n  //    let cell = world.tileMap.getCellByPoint(pos.x, pos.y);\r\n  //    hud.describe(`solid: ${cell.solid}`);\r\n  //   //  world.sp\r\n  //  }\r\n  // //  if (world && world.crafting) {\r\n  // //    // console.log(\"MOUSE MOVE while CRAFTING...\");\r\n  // //    let cell = world.tileMap.getCellByPoint(pos.x, pos.y);\r\n  // //    let x = cell.x, y = cell.y;\r\n  // //    let screenPos = game.worldToScreenCoordinates(new ex.Vector(x,y));\r\n  // //    //world.craftingItem = 'campfire';\r\n  // //    world.craftingAt = screenPos;\r\n  // //    //console.log(\"draw fire sprite at\", {x,y});\r\n  // //    //fireSprite.draw(game.ctx, x, y); //cell.x * 32, cell.y * 32);\r\n  // //  }\r\n  // });\r\n\r\n  game.input.pointers.primary.on('down', (e: ex.Input.PointerEvent) => {\r\n    let { pos } = e;\r\n    // console.log(\"CLICK\", { pos });\r\n    if (world && world.crafting) { // && world.ableToCraft()) {\r\n      // console.log(\"CLICK while CRAFTING\");\r\n      // hud.describe(`would build ${world.craftingItem}!`);\r\n      let kind = world.itemKinds[world.craftingItem];\r\n\r\n      let cell = world.tileMap.getCellByPoint(pos.x, pos.y);\r\n      //debugger;\r\n      world.spawn(kind, cell);\r\n      world.crafting = false;\r\n      world.debit(Material.Wood);\r\n      //world.primaryCharacter().a\r\n    } else {\r\n      if (world._primaryCharacter.equipped) {\r\n        world.primaryCharacter().useEquippedItem();\r\n      }\r\n    }\r\n  })\r\n\r\n});"],"sourceRoot":""}