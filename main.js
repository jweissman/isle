!function(e){function t(t){for(var n,r,a=t[0],c=t[1],l=t[2],d=0,p=[];d<a.length;d++)r=a[d],o[r]&&p.push(o[r][0]),o[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);p.length;)p.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],n=!0,a=1;a<s.length;a++){var c=s[a];0!==o[c]&&(n=!1)}n&&(i.splice(t--,1),e=r(r.s=s[0]))}return e}var n={},o={1:0},i=[];function r(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=n,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;i.push([13,0]),s()}([,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(0);t.clamp=((e,t)=>s=>{let n=Math.min(s,t);return Math.max(n,e)}),t.keyToDirection=(e=>{let t;return e!==n.Input.Keys.A&&e!==n.Input.Keys.Left||(t="left"),e!==n.Input.Keys.D&&e!==n.Input.Keys.Right||(t="right"),e!==n.Input.Keys.S&&e!==n.Input.Keys.Down||(t="down"),e!==n.Input.Keys.W&&e!==n.Input.Keys.Up||(t="up"),t}),t.oppositeWay=(e=>{let t;switch(e){case"left":t="right";break;case"right":t="left";break;case"up":t="down";break;case"down":t="up"}return t}),t.mode=(e=>{const t=new Map;let s,n=0;for(const o of e){let e=t.has(o)?t.get(o):0;++e>n&&(n=e,s=o),t.set(o,e)}return s}),t.addScalarToVec=((e,t,s)=>{switch(t){case"up":e.y-=s;break;case"down":e.y+=s;break;case"left":e.x-=s;break;case"right":e.x+=s}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(10);t.Player=n.Player;const o=s(9);t.Enemy=o.Enemy;const i=s(8);t.Logo=i.Logo},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(0);t.Game=class extends n.Engine{constructor(e,t){super({width:e,height:t,displayMode:n.DisplayMode.FullScreen})}start(e){return super.start(e)}}},function(e,t,s){e.exports=s.p+"b9b405c74e06d77b7a88f04d6d3ae5cd.png"},function(e,t,s){e.exports=s.p+"94754f62e0ae4d23d386e246f5e0cb6e.png"},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(0),o=s(6),i=s(5),r=s(4);let a={Sword:new n.Texture(i),Spritemap:new n.Texture(r),Map:new o.default("map/solidity.json")};t.Resources=a,a.Map.imagePathAccessor=((e,t)=>{let s=e.replace(/^(?:\.\.\/)+/,"");return console.log("LOAD IMG",{path:e,actualPath:s}),s})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(0),o=s(1);t.Logo=class extends n.Label{constructor(e,t,s){super(s),this.strobeClamp=o.clamp(50,200),this.strobe=(()=>{this.intensity=this.intensity+Math.ceil(16*Math.random())-8,this.intensity=this.strobeClamp(this.intensity),this.opacity=this.intensity/255}),this.x=e,this.y=t,this.fontFamily="Arial",this.fontSize=256,this.color=new n.Color(255,255,255),this.intensity=150,this.strobe()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(0);t.Enemy=class extends n.Actor{constructor({initialVelocity:e}){super(),this.setWidth(15),this.setHeight(15),this.x=200,this.y=200,this.color=n.Color.Red,this.collisionType=n.CollisionType.Passive,this.vel.setTo(e[0],e[1])}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(0),o=s(1);t.Player=class extends n.Actor{constructor(e,t){super(),this.x=e,this.y=t,this.wireMap=(e=>{this._map=e}),this.tryMove=(e=>{this.isBlocked(e)||this.move(e)}),this.move=(e=>{const t=this.speed;o.addScalarToVec(this.pos,e,t)}),this.isBlocked=(e=>{let t=this.pos.clone();o.addScalarToVec(t,e,this.speed);let s=this._map.getCellByPoint(t.x,t.y);return!s||s.solid}),this.setWidth(50),this.setHeight(250),this.color=new n.Color(255,255,255),this.speed=4}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(0),o=s(2),i=e=>{let t=document.createElement("button");return t.textContent=e,t};t.MainMenu=class extends n.Scene{onInitialize(e){const t=new o.Logo(e.drawWidth/2,400,"Isle");this.add(t),e.addTimer(new n.Timer(t.strobe,20,!0));const s=new class extends n.UIActor{constructor(e,t,s,n,o=i){super(),this.hide=(()=>this.rootElement.style.display="none"),this.rootElement=document.createElement("div"),this.rootElement.style.position="absolute",document.body.appendChild(this.rootElement),this.buttonElement=o(e),this.rootElement.appendChild(this.buttonElement),this.buttonElement.addEventListener("click",n)}draw(e){let t=this._engine.canvasHeight/window.devicePixelRatio,s=this._engine.canvasWidth/window.devicePixelRatio,n=e.canvas.offsetLeft,o=e.canvas.offsetTop,i=this.buttonElement.clientWidth,r=this.buttonElement.clientHeight;this.rootElement.style.left=`${n+s/2-i/2}px`,this.rootElement.style.top=`${o+t/2-r/2+100}px`}}("start game",e.drawWidth/2,400,()=>{s.hide(),e.goToScene("wander")});this.add(s)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(0);t.LevelOne=class extends n.Scene{onInitialize(e){}onActivate(){}onDeactivate(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(0),o=s(12),i=s(11),r=s(2),a=s(7),c=s(3),l=s(1),u=new c.Game(800,600),d=new i.MainMenu;u.add("main-menu",d);const p=new o.LevelOne,h=new n.SpriteSheet(a.Resources.Spritemap,8,8,31,31),y=new r.Player(192,192);y.addDrawing(h.getSprite(7)),u.input.keyboard.on("press",e=>{let{key:t}=e,s=l.keyToDirection(t);y.tryMove(s)}),u.input.keyboard.on("hold",e=>{let{key:t}=e,s=l.keyToDirection(t);y.tryMove(s)}),p.add(y),p.camera.strategy.lockToActor(y),u.add("wander",p);let f=new n.Loader;for(let e in a.Resources)f.addResource(a.Resources[e]);u.start(f).then(()=>{u.goToScene("wander");let e={},t={};a.Resources.Map.data.tilesets.forEach(s=>{s.terrains&&(s.terrains.forEach(t=>{e[t.tile]=t.properties.reduce((e,t)=>{let{name:s,value:n}=t;return Object.assign(e,{[s]:n})},{})}),t=s.tiles.reduce((t,s)=>{let{terrain:n,id:o}=s,i={solid:n.some(t=>e[t].solid)};return Object.assign(t,{[o]:i})},{}))});let s=a.Resources.Map.getTileMap();s.data.forEach(e=>{let s=t[e.sprites[0].spriteId];e=Object.assign(e,s)}),p.add(s),y.wireMap(s)})}]);
//# sourceMappingURL=main.js.map