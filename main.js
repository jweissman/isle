!function(e){function t(t){for(var o,r,l=t[0],c=t[1],a=t[2],d=0,h=[];d<l.length;d++)r=l[d],i[r]&&h.push(i[r][0]),i[r]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(u&&u(t);h.length;)h.shift()();return n.push.apply(n,a||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],o=!0,l=1;l<s.length;l++){var c=s[l];0!==i[c]&&(o=!1)}o&&(n.splice(t--,1),e=r(r.s=s[0]))}return e}var o={},i={1:0},n=[];function r(t){if(o[t])return o[t].exports;var s=o[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=o,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var l=window.webpackJsonp=window.webpackJsonp||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var a=0;a<l.length;a++)t(l[a]);var u=c;n.push([14,0]),s()}([,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(0);t.clamp=((e,t)=>s=>{let o=Math.min(s,t);return Math.max(o,e)}),t.keyToDirection=(e=>{let t;return e!==o.Input.Keys.A&&e!==o.Input.Keys.Left||(t="left"),e!==o.Input.Keys.D&&e!==o.Input.Keys.Right||(t="right"),e!==o.Input.Keys.S&&e!==o.Input.Keys.Down||(t="down"),e!==o.Input.Keys.W&&e!==o.Input.Keys.Up||(t="up"),t}),t.oppositeWay=(e=>{let t;switch(e){case"left":t="right";break;case"right":t="left";break;case"up":t="down";break;case"down":t="up"}return t}),t.mode=(e=>{const t=new Map;let s,o=0;for(const i of e){let e=t.has(i)?t.get(i):0;++e>o&&(o=e,s=i),t.set(i,e)}return s}),t.addScalarToVec=((e,t,s)=>{switch(t){case"up":e.y-=s;break;case"down":e.y+=s;break;case"left":e.x-=s;break;case"right":e.x+=s}}),t.dirFromVec=(e=>{let{x:t,y:s}=e;return Math.abs(t)>Math.abs(s)?t>0?"right":"left":s>0?"down":"up"})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(11);t.Player=o.Player;const i=s(10);t.Enemy=i.Enemy;const n=s(9);t.Logo=n.Logo},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(0);t.World=class{constructor(e,t){this.mapResource=e,this.debugBoxes=t,this._processTiledMap()}entityAt(e,t){return{nothing:"to see here"}}_processTiledMap(){let e=this.mapResource,t={},s={},i={};e.data.tilesets.forEach(e=>{console.log("TILESET",{ts:e}),e.terrains&&(e.terrains.forEach(e=>{e.properties&&(t[e.tile]=e.properties.reduce((e,t)=>{let{name:s,value:o}=t;return Object.assign(e,{[s]:o})},{}),t[e.tile].terrainName=e.name,console.log(`terrain ${e.name} (${e.tile}) has props: `,t[e.tile]))}),s=e.tiles.reduce((e,s)=>{let{terrain:o,id:i}=s,n={solid:o.some(e=>t[e]&&t[e].solid)};return Object.assign(e,{[i]:n})},{})),e.tiles&&e.tiles.some(e=>e.objectgroup)&&(i=e.tiles.reduce((e,t)=>{let{objectgroup:s,id:o}=t;return s&&s.objects&&s.objects.length?Object.assign(e,{[o]:s.objects[0]}):e},{}))}),this.tileMap=e.getTileMap(),this.blockingActors=[],this.tileMap.data.forEach(e=>{if(e.sprites[0]){let t=s[e.sprites[0].spriteId];if((e=Object.assign(e,t)).sprites[1]){const t=i[e.sprites[1].spriteId];if(t){let s=new o.Actor(e.x,e.y,32,32);s.collisionType=o.CollisionType.Fixed,s.body.useCircleCollision(t.height/2,new o.Vector(t.x,t.y)),this.debugBoxes&&(console.log({collision:t,block:s}),s.draw=(e=>{s.collisionArea.debugDraw(e,o.Color.LightGray)})),this.blockingActors.push(s)}}}})}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(0);t.Game=class extends o.Engine{constructor(e,t){super({width:e,height:t,displayMode:o.DisplayMode.FullScreen})}start(e){return super.start(e)}}},function(e,t,s){e.exports=s.p+"b9b405c74e06d77b7a88f04d6d3ae5cd.png"},function(e,t,s){e.exports=s.p+"94754f62e0ae4d23d386e246f5e0cb6e.png"},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(0),i=s(7),n=s(6),r=s(5);let l={Sword:new o.Texture(n),Spritemap:new o.Texture(r),Map:new i.default("map/solidity.json")};t.Resources=l,l.Map.imagePathAccessor=((e,t)=>{let s=e.replace(/^(?:\.\.\/)+/,"");return console.log("LOAD IMG",{path:e,actualPath:s}),s})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(0),i=s(1);t.Logo=class extends o.Label{constructor(e,t,s){super(s),this.strobeClamp=i.clamp(50,200),this.strobe=(()=>{this.intensity=this.intensity+Math.ceil(16*Math.random())-8,this.intensity=this.strobeClamp(this.intensity),this.opacity=this.intensity/255}),this.x=e,this.y=t,this.fontFamily="Arial",this.fontSize=256,this.color=new o.Color(255,255,255),this.intensity=150,this.strobe()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(0);t.Enemy=class extends o.Actor{constructor({initialVelocity:e}){super(),this.setWidth(15),this.setHeight(15),this.x=200,this.y=200,this.color=o.Color.Red,this.collisionType=o.CollisionType.Passive,this.vel.setTo(e[0],e[1])}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(0),i=s(1);t.Player=class extends o.Actor{constructor(e,t){super(),this.x=e,this.y=t,this.wireWorld=(e=>{this._world=e}),this.halt=(()=>this.vel=new o.Vector(0,0)),this.move=(e=>{this.facing=e;const t=this.speed;"left"===e&&(this.vel.x=-t),"right"===e&&(this.vel.x=t),"up"===e&&(this.vel.y=-t),"down"===e&&(this.vel.y=t)}),this.setWidth(20),this.setHeight(10),this.collisionArea.pos.y=8,this.collisionArea.pos.x=-4,this.color=new o.Color(255,255,255),this.collisionType=o.CollisionType.Active,this.speed=128,this.on("precollision",this.halt),this.facing="down"}interact(){let e=this.getCenter().clone();i.addScalarToVec(e,this.facing,32);let t=this._world.entityAt(e.x,e.y);console.log("ENTITY IS",{entity:t})}draw(e,t){this.collisionArea.debugDraw(e,o.Color.Chartreuse),super.draw(e,t)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(0),i=s(2),n=e=>{let t=document.createElement("button");return t.textContent=e,t};t.MainMenu=class extends o.Scene{onInitialize(e){const t=new i.Logo(e.drawWidth/2,400,"Isle");this.add(t),e.addTimer(new o.Timer(t.strobe,20,!0));const s=new class extends o.UIActor{constructor(e,t,s,o,i=n){super(),this.hide=(()=>this.rootElement.style.display="none"),this.rootElement=document.createElement("div"),this.rootElement.style.position="absolute",document.body.appendChild(this.rootElement),this.buttonElement=i(e),this.rootElement.appendChild(this.buttonElement),this.buttonElement.addEventListener("click",o)}draw(e){let t=this._engine.canvasHeight/window.devicePixelRatio,s=this._engine.canvasWidth/window.devicePixelRatio,o=e.canvas.offsetLeft,i=e.canvas.offsetTop,n=this.buttonElement.clientWidth,r=this.buttonElement.clientHeight;this.rootElement.style.left=`${o+s/2-n/2}px`,this.rootElement.style.top=`${i+t/2-r/2+100}px`}}("start game",e.drawWidth/2,400,()=>{s.hide(),e.goToScene("wander")});this.add(s)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(0);t.LevelOne=class extends o.Scene{onInitialize(e){}onActivate(){}onDeactivate(){}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(0),i=s(13),n=s(12),r=s(2),l=s(8),c=s(4),a=s(1),u=s(3),d=new c.Game(800,600),h=new n.MainMenu;d.add("main-menu",h);const p=new i.LevelOne,y=new o.SpriteSheet(l.Resources.Spritemap,8,8,32,32),f=new r.Player(128,128);f.addDrawing(y.getSprite(7)),d.input.keyboard.on("press",e=>{let{key:t}=e;if(t==o.Input.Keys.E)console.log("INTERACT?!"),f.interact();else{let e=a.keyToDirection(t);e&&f.move(e)}}),d.input.keyboard.on("hold",e=>{let{key:t}=e,s=a.keyToDirection(t);s&&f.move(s)}),d.input.keyboard.on("release",e=>{console.log("RELEASE",{evt:e});let{key:t}=e;a.keyToDirection(t)&&f.halt()}),p.add(f),p.camera.strategy.lockToActor(f),p.camera.zoom(3),d.add("wander",p);let b=new o.Loader;for(let e in l.Resources)b.addResource(l.Resources[e]);d.start(b).then(()=>{d.goToScene("wander");let e=new u.World(l.Resources.Map,!0),t=e.tileMap;p.addTileMap(t),f.wireWorld(e),e.blockingActors.forEach(e=>p.add(e))})}]);
//# sourceMappingURL=main.js.map